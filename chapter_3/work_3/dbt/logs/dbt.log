[0m22:39:32.087121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b211a8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b216946b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b211a8c20>]}


============================== 22:39:32.131924 | edb7e87a-4934-415a-9532-92a394eb9426 ==============================
[0m22:39:32.131924 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:39:32.133033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:39:32.138717 [error] [MainThread]: Encountered an error:
argument of type 'NoneType' is not iterable
[0m22:39:32.141532 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 215, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/config/runtime.py", line 71, in load_profile
    profile = Profile.render(
              ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/config/profile.py", line 403, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/config/profile.py", line 369, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/config/profile.py", line 315, in from_raw_profile_info
    target_name, profile_data = cls.render_profile(
                                ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/config/profile.py", line 281, in render_profile
    raw_profile_data = cls._get_profile_data(raw_profile, profile_name, target_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/config/profile.py", line 206, in _get_profile_data
    if target_name not in outputs:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: argument of type 'NoneType' is not iterable

[0m22:39:32.143128 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.18539013, "process_user_time": 3.801888, "process_kernel_time": 0.289999, "process_mem_max_rss": "108912", "process_in_blocks": "31104", "process_out_blocks": "4072", "command_success": false}
[0m22:39:32.144198 [debug] [MainThread]: Command `dbt run` failed at 22:39:32.143993 after 0.19 seconds
[0m22:39:32.145063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b211abad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b2174b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b209ef590>]}
[0m22:39:32.145938 [debug] [MainThread]: Flushing usage events
[0m22:42:27.251189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78256e3a9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78256bdc9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78256f7eb2c0>]}


============================== 22:42:27.260549 | 3c1d50d7-02a5-4cd0-8d9e-14c9ff72f049 ==============================
[0m22:42:27.260549 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:42:27.261910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:42:27.568058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c1d50d7-02a5-4cd0-8d9e-14c9ff72f049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78256bbc5c40>]}
[0m22:42:27.672454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c1d50d7-02a5-4cd0-8d9e-14c9ff72f049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78256b846c60>]}
[0m22:42:27.679906 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:42:27.948069 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:42:27.950234 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:42:27.953128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3c1d50d7-02a5-4cd0-8d9e-14c9ff72f049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78256f7eb2c0>]}
[0m22:42:30.194578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c1d50d7-02a5-4cd0-8d9e-14c9ff72f049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782569f0cb90>]}
[0m22:42:30.396747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c1d50d7-02a5-4cd0-8d9e-14c9ff72f049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78256a3f22a0>]}
[0m22:42:30.397799 [info ] [MainThread]: Found 9 models, 7 sources, 428 macros
[0m22:42:30.399354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c1d50d7-02a5-4cd0-8d9e-14c9ff72f049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782569b352b0>]}
[0m22:42:30.403561 [info ] [MainThread]: 
[0m22:42:30.405890 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:42:30.417641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:42:30.497274 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:42:30.498700 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:42:30.499944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:30.511714 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m22:42:30.515227 [debug] [ThreadPool]: On list_airflow: Close
[0m22:42:30.521011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_driven_staging)
[0m22:42:30.522232 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "driven_staging"
"
[0m22:42:30.539058 [debug] [ThreadPool]: Using postgres connection "create_airflow_driven_staging"
[0m22:42:30.540101 [debug] [ThreadPool]: On create_airflow_driven_staging: BEGIN
[0m22:42:30.540984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:30.549122 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:42:30.550170 [debug] [ThreadPool]: Using postgres connection "create_airflow_driven_staging"
[0m22:42:30.551469 [debug] [ThreadPool]: On create_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_driven_staging"} */
create schema if not exists "driven_staging"
[0m22:42:30.556449 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m22:42:30.559346 [debug] [ThreadPool]: On create_airflow_driven_staging: COMMIT
[0m22:42:30.560724 [debug] [ThreadPool]: Using postgres connection "create_airflow_driven_staging"
[0m22:42:30.561751 [debug] [ThreadPool]: On create_airflow_driven_staging: COMMIT
[0m22:42:30.564887 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m22:42:30.565472 [debug] [ThreadPool]: On create_airflow_driven_staging: Close
[0m22:42:30.570014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_driven_staging, now list_airflow_driven_trusted)
[0m22:42:30.581335 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m22:42:30.583016 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m22:42:30.584453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:30.590375 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:42:30.591349 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m22:42:30.592150 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m22:42:30.598467 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m22:42:30.602276 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m22:42:30.603316 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m22:42:30.604610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now list_airflow_driven_staging)
[0m22:42:30.611885 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m22:42:30.612728 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m22:42:30.613569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:30.621678 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:42:30.622347 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m22:42:30.622824 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m22:42:30.626892 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m22:42:30.628987 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m22:42:30.630314 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m22:42:30.645280 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:30.646221 [debug] [MainThread]: On master: BEGIN
[0m22:42:30.647138 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:42:30.654171 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:42:30.655391 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:30.656491 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:42:30.663464 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m22:42:30.667755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c1d50d7-02a5-4cd0-8d9e-14c9ff72f049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78256b8684d0>]}
[0m22:42:30.669251 [debug] [MainThread]: On master: ROLLBACK
[0m22:42:30.671929 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:30.672890 [debug] [MainThread]: On master: BEGIN
[0m22:42:30.674424 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:42:30.675445 [debug] [MainThread]: On master: COMMIT
[0m22:42:30.676284 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:30.677133 [debug] [MainThread]: On master: COMMIT
[0m22:42:30.678183 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:42:30.679111 [debug] [MainThread]: On master: Close
[0m22:42:30.680347 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:42:30.682360 [info ] [MainThread]: 
[0m22:42:30.706892 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_address
[0m22:42:30.708370 [info ] [Thread-1 (]: 1 of 5 START sql table model driven_staging.dim_address ........................ [RUN]
[0m22:42:30.709557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now model.dbt_driven_data.staging_dim_address)
[0m22:42:30.710576 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_address
[0m22:42:30.733662 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_address"
[0m22:42:30.735176 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_address
[0m22:42:30.939306 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_address"
[0m22:42:30.941283 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m22:42:30.942701 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: BEGIN
[0m22:42:30.943897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:30.951218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m22:42:30.952841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m22:42:30.954699 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */

  
    

  create  table "airflow"."driven_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 unique_id,
 address,
 mac_address,
 ip_address
 FROM
 "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m22:42:30.973959 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.018 seconds
[0m22:42:30.996231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m22:42:30.997724 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m22:42:30.999673 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:42:31.058514 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m22:42:31.059672 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m22:42:31.060938 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m22:42:31.063786 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:42:31.081634 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_address__dbt_backup"
[0m22:42:31.096732 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m22:42:31.098176 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
drop table if exists "airflow"."driven_staging"."dim_address__dbt_backup" cascade
[0m22:42:31.099969 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:42:31.106679 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: Close
[0m22:42:31.113735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c1d50d7-02a5-4cd0-8d9e-14c9ff72f049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78256d0f1b20>]}
[0m22:42:31.116540 [info ] [Thread-1 (]: 1 of 5 OK created sql table model driven_staging.dim_address ................... [[32mSELECT 0[0m in 0.40s]
[0m22:42:31.118967 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_address
[0m22:42:31.120384 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_date
[0m22:42:31.122208 [info ] [Thread-1 (]: 2 of 5 START sql table model driven_staging.dim_date ........................... [RUN]
[0m22:42:31.123748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_address, now model.dbt_driven_data.staging_dim_date)
[0m22:42:31.124921 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_date
[0m22:42:31.133390 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_date"
[0m22:42:31.134839 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_date
[0m22:42:31.144541 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_date"
[0m22:42:31.146027 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m22:42:31.147156 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: BEGIN
[0m22:42:31.148363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:31.156620 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:42:31.158007 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m22:42:31.159360 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */

  
    

  create  table "airflow"."driven_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m22:42:31.163303 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m22:42:31.173060 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m22:42:31.174428 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m22:42:31.176075 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:42:31.181031 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m22:42:31.183075 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m22:42:31.185248 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m22:42:31.187726 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:42:31.194176 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_date__dbt_backup"
[0m22:42:31.196513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m22:42:31.198480 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
drop table if exists "airflow"."driven_staging"."dim_date__dbt_backup" cascade
[0m22:42:31.200472 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:42:31.204620 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: Close
[0m22:42:31.206420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c1d50d7-02a5-4cd0-8d9e-14c9ff72f049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78256bc1a300>]}
[0m22:42:31.208247 [info ] [Thread-1 (]: 2 of 5 OK created sql table model driven_staging.dim_date ...................... [[32mSELECT 0[0m in 0.08s]
[0m22:42:31.210180 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_date
[0m22:42:31.211280 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_finance
[0m22:42:31.212408 [info ] [Thread-1 (]: 3 of 5 START sql table model driven_staging.dim_finance ........................ [RUN]
[0m22:42:31.214258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_date, now model.dbt_driven_data.staging_dim_finance)
[0m22:42:31.218024 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_finance
[0m22:42:31.225066 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_finance"
[0m22:42:31.225829 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_finance
[0m22:42:31.236156 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_finance"
[0m22:42:31.237121 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m22:42:31.237851 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: BEGIN
[0m22:42:31.238504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:31.243272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m22:42:31.243947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m22:42:31.244709 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */

  
    

  create  table "airflow"."driven_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 unique_id,
 iban
 FROM
 "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m22:42:31.248985 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m22:42:31.255547 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m22:42:31.256226 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m22:42:31.257238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:42:31.259916 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m22:42:31.260514 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m22:42:31.261094 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m22:42:31.262932 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:42:31.268997 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_finance__dbt_backup"
[0m22:42:31.270773 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m22:42:31.271679 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
drop table if exists "airflow"."driven_staging"."dim_finance__dbt_backup" cascade
[0m22:42:31.272633 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:42:31.274660 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: Close
[0m22:42:31.275665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c1d50d7-02a5-4cd0-8d9e-14c9ff72f049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782569b0bb90>]}
[0m22:42:31.277444 [info ] [Thread-1 (]: 3 of 5 OK created sql table model driven_staging.dim_finance ................... [[32mSELECT 0[0m in 0.06s]
[0m22:42:31.279455 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_finance
[0m22:42:31.280865 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_person
[0m22:42:31.282370 [info ] [Thread-1 (]: 4 of 5 START sql table model driven_staging.dim_person ......................... [RUN]
[0m22:42:31.283446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_finance, now model.dbt_driven_data.staging_dim_person)
[0m22:42:31.284065 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_person
[0m22:42:31.288841 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_person"
[0m22:42:31.289924 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_person
[0m22:42:31.303204 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_person"
[0m22:42:31.304866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m22:42:31.306751 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: BEGIN
[0m22:42:31.308574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:31.316510 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:42:31.321218 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m22:42:31.322386 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */

  
    

  create  table "airflow"."driven_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 unique_id,
 person_name,
 user_name,
 email,
 phone,
 birth_date,
 personal_number
 FROM
 "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m22:42:31.330023 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m22:42:31.351682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m22:42:31.353345 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m22:42:31.357693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:42:31.366847 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m22:42:31.368094 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m22:42:31.369244 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m22:42:31.371550 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:42:31.379037 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_person__dbt_backup"
[0m22:42:31.384221 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m22:42:31.387309 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
drop table if exists "airflow"."driven_staging"."dim_person__dbt_backup" cascade
[0m22:42:31.388781 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:42:31.393713 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: Close
[0m22:42:31.397239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c1d50d7-02a5-4cd0-8d9e-14c9ff72f049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78256a775bb0>]}
[0m22:42:31.401423 [info ] [Thread-1 (]: 4 of 5 OK created sql table model driven_staging.dim_person .................... [[32mSELECT 0[0m in 0.11s]
[0m22:42:31.403205 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_person
[0m22:42:31.404423 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_fact_network_usage
[0m22:42:31.408932 [info ] [Thread-1 (]: 5 of 5 START sql table model driven_staging.fact_network_usage ................. [RUN]
[0m22:42:31.410454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_person, now model.dbt_driven_data.staging_fact_network_usage)
[0m22:42:31.411594 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_fact_network_usage
[0m22:42:31.424482 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_fact_network_usage"
[0m22:42:31.425791 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_fact_network_usage
[0m22:42:31.437871 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_fact_network_usage"
[0m22:42:31.439348 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m22:42:31.440427 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: BEGIN
[0m22:42:31.441509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:31.450212 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m22:42:31.451550 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m22:42:31.452718 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."driven_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 unique_id,
 session_duration,
 download_speed,
 upload_speed,
 consumed_traffic
 FROM
 "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m22:42:31.455644 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m22:42:31.460503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m22:42:31.461299 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m22:42:31.462399 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:42:31.467015 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m22:42:31.469275 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m22:42:31.470284 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m22:42:31.472614 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:42:31.478677 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."fact_network_usage__dbt_backup"
[0m22:42:31.482129 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m22:42:31.483313 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
drop table if exists "airflow"."driven_staging"."fact_network_usage__dbt_backup" cascade
[0m22:42:31.486037 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:42:31.488805 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: Close
[0m22:42:31.489971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c1d50d7-02a5-4cd0-8d9e-14c9ff72f049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78256818bf20>]}
[0m22:42:31.491715 [info ] [Thread-1 (]: 5 of 5 OK created sql table model driven_staging.fact_network_usage ............ [[32mSELECT 0[0m in 0.08s]
[0m22:42:31.493829 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_fact_network_usage
[0m22:42:31.496292 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:31.497294 [debug] [MainThread]: On master: BEGIN
[0m22:42:31.498769 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:42:31.505789 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:42:31.507157 [debug] [MainThread]: On master: COMMIT
[0m22:42:31.508423 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:31.509663 [debug] [MainThread]: On master: COMMIT
[0m22:42:31.512061 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:42:31.513271 [debug] [MainThread]: On master: Close
[0m22:42:31.514649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:42:31.516002 [debug] [MainThread]: Connection 'model.dbt_driven_data.staging_fact_network_usage' was properly closed.
[0m22:42:31.517403 [info ] [MainThread]: 
[0m22:42:31.519193 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m22:42:31.523809 [debug] [MainThread]: Command end result
[0m22:42:31.593112 [info ] [MainThread]: 
[0m22:42:31.593812 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:42:31.594397 [info ] [MainThread]: 
[0m22:42:31.595109 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:42:31.597089 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4660926, "process_user_time": 6.981183, "process_kernel_time": 0.417218, "process_mem_max_rss": "123188", "process_in_blocks": "4880", "process_out_blocks": "2792"}
[0m22:42:31.598752 [debug] [MainThread]: Command `dbt run` succeeded at 22:42:31.598370 after 4.47 seconds
[0m22:42:31.600023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78256beed5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78256bd9af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78256bd9be90>]}
[0m22:42:31.601076 [debug] [MainThread]: Flushing usage events
[0m22:42:37.466155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a86aeed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a8275220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a81de270>]}


============================== 22:42:37.476561 | bba54fd0-9a14-42c3-bb5a-78ea74b828b3 ==============================
[0m22:42:37.476561 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:42:37.477491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:trusted', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:42:37.762567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bba54fd0-9a14-42c3-bb5a-78ea74b828b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a7b5c470>]}
[0m22:42:37.862684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bba54fd0-9a14-42c3-bb5a-78ea74b828b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a86f5160>]}
[0m22:42:37.863825 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:42:38.075074 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:42:38.269734 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:42:38.270410 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:42:38.330686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bba54fd0-9a14-42c3-bb5a-78ea74b828b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a73808c0>]}
[0m22:42:38.508219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bba54fd0-9a14-42c3-bb5a-78ea74b828b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a6b385c0>]}
[0m22:42:38.508971 [info ] [MainThread]: Found 9 models, 7 sources, 428 macros
[0m22:42:38.509554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bba54fd0-9a14-42c3-bb5a-78ea74b828b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a677ecc0>]}
[0m22:42:38.512613 [info ] [MainThread]: 
[0m22:42:38.513505 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:42:38.521866 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m22:42:38.582711 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m22:42:38.583471 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m22:42:38.584463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:38.591615 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m22:42:38.593472 [debug] [ThreadPool]: On list_airflow: Close
[0m22:42:38.594715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_driven_trusted)
[0m22:42:38.595567 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "driven_trusted"
"
[0m22:42:38.604989 [debug] [ThreadPool]: Using postgres connection "create_airflow_driven_trusted"
[0m22:42:38.605643 [debug] [ThreadPool]: On create_airflow_driven_trusted: BEGIN
[0m22:42:38.606410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:38.611302 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m22:42:38.612414 [debug] [ThreadPool]: Using postgres connection "create_airflow_driven_trusted"
[0m22:42:38.613590 [debug] [ThreadPool]: On create_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_driven_trusted"} */
create schema if not exists "driven_trusted"
[0m22:42:38.615054 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m22:42:38.616810 [debug] [ThreadPool]: On create_airflow_driven_trusted: COMMIT
[0m22:42:38.618368 [debug] [ThreadPool]: Using postgres connection "create_airflow_driven_trusted"
[0m22:42:38.619366 [debug] [ThreadPool]: On create_airflow_driven_trusted: COMMIT
[0m22:42:38.627228 [debug] [ThreadPool]: SQL status: COMMIT in 0.007 seconds
[0m22:42:38.627836 [debug] [ThreadPool]: On create_airflow_driven_trusted: Close
[0m22:42:38.631430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_driven_trusted, now list_airflow_driven_staging)
[0m22:42:38.642597 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m22:42:38.643787 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m22:42:38.644369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:38.649507 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m22:42:38.650487 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m22:42:38.651454 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m22:42:38.660312 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m22:42:38.663155 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m22:42:38.663847 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m22:42:38.665045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now list_airflow_driven_trusted)
[0m22:42:38.671013 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m22:42:38.671568 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m22:42:38.672261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:38.677427 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m22:42:38.678227 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m22:42:38.678697 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m22:42:38.682751 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m22:42:38.684532 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m22:42:38.685345 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m22:42:38.697124 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:38.697684 [debug] [MainThread]: On master: BEGIN
[0m22:42:38.698164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:42:38.703383 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m22:42:38.704612 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:38.705920 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:42:38.710606 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m22:42:38.712656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bba54fd0-9a14-42c3-bb5a-78ea74b828b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a630bf20>]}
[0m22:42:38.713350 [debug] [MainThread]: On master: ROLLBACK
[0m22:42:38.714029 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:38.714597 [debug] [MainThread]: On master: BEGIN
[0m22:42:38.715731 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:42:38.716385 [debug] [MainThread]: On master: COMMIT
[0m22:42:38.716930 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:38.717468 [debug] [MainThread]: On master: COMMIT
[0m22:42:38.718482 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:42:38.719336 [debug] [MainThread]: On master: Close
[0m22:42:38.720629 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:42:38.721938 [info ] [MainThread]: 
[0m22:42:38.738279 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_non_pii_data
[0m22:42:38.739681 [info ] [Thread-1 (]: 1 of 4 START sql table model driven_trusted.non_pii_data ....................... [RUN]
[0m22:42:38.740550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now model.dbt_driven_data.trusted_non_pii_data)
[0m22:42:38.741449 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_non_pii_data
[0m22:42:38.754915 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_non_pii_data"
[0m22:42:38.755749 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_non_pii_data
[0m22:42:38.815529 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_non_pii_data"
[0m22:42:38.816509 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m22:42:38.817194 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: BEGIN
[0m22:42:38.817988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:38.823829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m22:42:38.826636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m22:42:38.828378 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 '***MASKED***' AS person_name,
 SUBSTRING(dp.user_name, 1, 5) || '*****' user_name,
 SUBSTRING(dp.email, 1, 5) || '*****' AS email,
 '***MASKED***' AS personal_number,
 '***MASKED***' AS birth_date,
 '***MASKED***' AS address,
 '***MASKED***' AS phone,
 SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
 SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
 SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
 dd.accessed_at,
 fnu.session_duration,
 fnu.download_speed,
 fnu.upload_speed,
 fnu.consumed_traffic,
 fnu.unique_id
 FROM
 "airflow"."driven_staging"."fact_network_usage" fnu
 INNER JOIN
 "airflow"."driven_staging"."dim_address" da ON
fnu.unique_id = da.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_date" dd ON da.unique_id =
dd.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_finance" df ON dd.unique_id
= df.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_person" dp ON df.unique_id
= dp.unique_id
)
SELECT
 *
FROM
 source_data
  );
  
[0m22:42:38.838502 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m22:42:38.849793 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m22:42:38.850926 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m22:42:38.852087 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:42:38.881743 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m22:42:38.882548 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m22:42:38.883251 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m22:42:38.885027 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:42:38.895036 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."non_pii_data__dbt_backup"
[0m22:42:38.903209 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m22:42:38.904360 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
drop table if exists "airflow"."driven_trusted"."non_pii_data__dbt_backup" cascade
[0m22:42:38.905382 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:42:38.909474 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: Close
[0m22:42:38.911655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba54fd0-9a14-42c3-bb5a-78ea74b828b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a94d9b50>]}
[0m22:42:38.912655 [info ] [Thread-1 (]: 1 of 4 OK created sql table model driven_trusted.non_pii_data .................. [[32mSELECT 0[0m in 0.17s]
[0m22:42:38.913885 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_non_pii_data
[0m22:42:38.914791 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_payment_data
[0m22:42:38.915549 [info ] [Thread-1 (]: 2 of 4 START sql table model driven_trusted.payment_data ....................... [RUN]
[0m22:42:38.916504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_non_pii_data, now model.dbt_driven_data.trusted_payment_data)
[0m22:42:38.917306 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_payment_data
[0m22:42:38.923570 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_payment_data"
[0m22:42:38.924588 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_payment_data
[0m22:42:38.929513 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_payment_data"
[0m22:42:38.930433 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m22:42:38.930979 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: BEGIN
[0m22:42:38.931507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:38.936642 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m22:42:38.938281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m22:42:38.939555 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */

  
    

  create  table "airflow"."driven_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 fnu.unique_id,
 df.iban,
 fnu.download_speed,
 fnu.upload_speed,
 fnu.session_duration,
 fnu.consumed_traffic,
 ((fnu.download_speed + fnu.upload_speed + 1)/2) +
(fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
 FROM
 "airflow"."driven_staging"."fact_network_usage" fnu
 JOIN
 "airflow"."driven_staging"."dim_finance" df
 ON
 fnu.unique_id = df.unique_id
)
SELECT
 *
FROM
 source_data
  );
  
[0m22:42:38.944275 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m22:42:38.948592 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m22:42:38.949160 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m22:42:38.950067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:42:38.952828 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m22:42:38.954123 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m22:42:38.955177 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m22:42:38.957270 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:42:38.961588 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."payment_data__dbt_backup"
[0m22:42:38.963122 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m22:42:38.963720 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
drop table if exists "airflow"."driven_trusted"."payment_data__dbt_backup" cascade
[0m22:42:38.964505 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:42:38.966316 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: Close
[0m22:42:38.967261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba54fd0-9a14-42c3-bb5a-78ea74b828b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a73cb3e0>]}
[0m22:42:38.969082 [info ] [Thread-1 (]: 2 of 4 OK created sql table model driven_trusted.payment_data .................. [[32mSELECT 0[0m in 0.05s]
[0m22:42:38.971312 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_payment_data
[0m22:42:38.972521 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_pii_data
[0m22:42:38.973808 [info ] [Thread-1 (]: 3 of 4 START sql table model driven_trusted.pii_data ........................... [RUN]
[0m22:42:38.974948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_payment_data, now model.dbt_driven_data.trusted_pii_data)
[0m22:42:38.975925 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_pii_data
[0m22:42:38.981448 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_pii_data"
[0m22:42:38.982231 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_pii_data
[0m22:42:38.988431 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_pii_data"
[0m22:42:38.989293 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m22:42:38.989924 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: BEGIN
[0m22:42:38.990595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:38.995641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m22:42:38.996420 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m22:42:38.997195 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 dp.person_name,
 dp.user_name,
 dp.email,
 dp.personal_number,
 dp.birth_date,
 da.address,
 dp.phone,
 da.mac_address,
 da.ip_address,
 df.iban,
 dd.accessed_at,
 fnu.session_duration,
 fnu.download_speed,
 fnu.upload_speed,
 fnu.consumed_traffic,
 fnu.unique_id
 FROM
 "airflow"."driven_staging"."fact_network_usage" fnu
 INNER JOIN
 "airflow"."driven_staging"."dim_address" da ON
fnu.unique_id = da.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_date" dd ON da.unique_id =
dd.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_finance" df ON dd.unique_id
= df.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_person" dp ON df.unique_id
= dp.unique_id
)
SELECT
 *
FROM
 source_data
  );
  
[0m22:42:39.007051 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m22:42:39.011442 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m22:42:39.012056 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m22:42:39.012987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:42:39.015255 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m22:42:39.015791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m22:42:39.016332 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m22:42:39.017914 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:42:39.025297 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."pii_data__dbt_backup"
[0m22:42:39.026580 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m22:42:39.027191 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
drop table if exists "airflow"."driven_trusted"."pii_data__dbt_backup" cascade
[0m22:42:39.028070 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:42:39.029902 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: Close
[0m22:42:39.030803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba54fd0-9a14-42c3-bb5a-78ea74b828b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a4e47530>]}
[0m22:42:39.032457 [info ] [Thread-1 (]: 3 of 4 OK created sql table model driven_trusted.pii_data ...................... [[32mSELECT 0[0m in 0.06s]
[0m22:42:39.034158 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_pii_data
[0m22:42:39.034972 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_technical_data
[0m22:42:39.036046 [info ] [Thread-1 (]: 4 of 4 START sql table model driven_trusted.technical_data ..................... [RUN]
[0m22:42:39.037006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_pii_data, now model.dbt_driven_data.trusted_technical_data)
[0m22:42:39.038071 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_technical_data
[0m22:42:39.046207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_technical_data"
[0m22:42:39.047010 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_technical_data
[0m22:42:39.051449 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_technical_data"
[0m22:42:39.052548 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m22:42:39.053565 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: BEGIN
[0m22:42:39.054380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:39.059228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m22:42:39.060121 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m22:42:39.060974 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */

  
    

  create  table "airflow"."driven_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 fnu.unique_id,
 da.address,
 da.mac_address,
 da.ip_address,
 fnu.download_speed,
 fnu.upload_speed,
 ROUND((fnu.session_duration/60), 1) as min_session_duration,
 CASE
WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR
fnu.session_duration/60 < 1 THEN true
 ELSE false
 END AS technical_issue
 FROM
 "airflow"."driven_staging"."fact_network_usage" fnu
 JOIN
 "airflow"."driven_staging"."dim_address" da
 ON
 fnu.unique_id = da.unique_id
)
SELECT
 *
FROM
 source_data
  );
  
[0m22:42:39.069743 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m22:42:39.084229 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m22:42:39.085886 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m22:42:39.089196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:42:39.094547 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m22:42:39.095342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m22:42:39.096003 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m22:42:39.097900 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:42:39.101569 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."technical_data__dbt_backup"
[0m22:42:39.103984 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m22:42:39.105337 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
drop table if exists "airflow"."driven_trusted"."technical_data__dbt_backup" cascade
[0m22:42:39.106644 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:42:39.110460 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: Close
[0m22:42:39.111527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba54fd0-9a14-42c3-bb5a-78ea74b828b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a4e010a0>]}
[0m22:42:39.112683 [info ] [Thread-1 (]: 4 of 4 OK created sql table model driven_trusted.technical_data ................ [[32mSELECT 0[0m in 0.07s]
[0m22:42:39.114055 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_technical_data
[0m22:42:39.115943 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:39.116530 [debug] [MainThread]: On master: BEGIN
[0m22:42:39.117593 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:42:39.123282 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:42:39.124712 [debug] [MainThread]: On master: COMMIT
[0m22:42:39.126708 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:39.127815 [debug] [MainThread]: On master: COMMIT
[0m22:42:39.129385 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:42:39.130686 [debug] [MainThread]: On master: Close
[0m22:42:39.132043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:42:39.133163 [debug] [MainThread]: Connection 'model.dbt_driven_data.trusted_technical_data' was properly closed.
[0m22:42:39.134305 [info ] [MainThread]: 
[0m22:42:39.136531 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m22:42:39.141098 [debug] [MainThread]: Command end result
[0m22:42:39.197648 [info ] [MainThread]: 
[0m22:42:39.199070 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:42:39.200148 [info ] [MainThread]: 
[0m22:42:39.201233 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:42:39.203337 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8860023, "process_user_time": 4.735067, "process_kernel_time": 0.345348, "process_mem_max_rss": "119704", "process_out_blocks": "1928", "process_in_blocks": "0"}
[0m22:42:39.205185 [debug] [MainThread]: Command `dbt run` succeeded at 22:42:39.204754 after 1.89 seconds
[0m22:42:39.206609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a8337980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a7f97e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a4fac050>]}
[0m22:42:39.210513 [debug] [MainThread]: Flushing usage events
[0m23:37:40.499601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d8970ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d7519010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d608a270>]}


============================== 23:37:40.536540 | 585c29df-515a-4989-95a9-83d21431ecb0 ==============================
[0m23:37:40.536540 [info ] [MainThread]: Running with dbt=1.8.0
[0m23:37:40.537566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:37:40.846193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '585c29df-515a-4989-95a9-83d21431ecb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d6902000>]}
[0m23:37:40.947563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '585c29df-515a-4989-95a9-83d21431ecb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d70e2960>]}
[0m23:37:40.949225 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:37:41.132953 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m23:37:41.341297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:37:41.341915 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:37:41.411564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '585c29df-515a-4989-95a9-83d21431ecb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d5e5f1d0>]}
[0m23:37:41.574446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '585c29df-515a-4989-95a9-83d21431ecb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d5301a90>]}
[0m23:37:41.575193 [info ] [MainThread]: Found 9 models, 7 sources, 428 macros
[0m23:37:41.575892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '585c29df-515a-4989-95a9-83d21431ecb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d53c2570>]}
[0m23:37:41.578547 [info ] [MainThread]: 
[0m23:37:41.579595 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:37:41.586927 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:37:41.656584 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:37:41.657278 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:37:41.657865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:41.663830 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m23:37:41.665724 [debug] [ThreadPool]: On list_airflow: Close
[0m23:37:41.667059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_driven_staging)
[0m23:37:41.668039 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "driven_staging"
"
[0m23:37:41.676707 [debug] [ThreadPool]: Using postgres connection "create_airflow_driven_staging"
[0m23:37:41.677321 [debug] [ThreadPool]: On create_airflow_driven_staging: BEGIN
[0m23:37:41.677789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:41.682728 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m23:37:41.683812 [debug] [ThreadPool]: Using postgres connection "create_airflow_driven_staging"
[0m23:37:41.685038 [debug] [ThreadPool]: On create_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_driven_staging"} */
create schema if not exists "driven_staging"
[0m23:37:41.687309 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m23:37:41.689985 [debug] [ThreadPool]: On create_airflow_driven_staging: COMMIT
[0m23:37:41.690625 [debug] [ThreadPool]: Using postgres connection "create_airflow_driven_staging"
[0m23:37:41.691257 [debug] [ThreadPool]: On create_airflow_driven_staging: COMMIT
[0m23:37:41.693001 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m23:37:41.693590 [debug] [ThreadPool]: On create_airflow_driven_staging: Close
[0m23:37:41.696203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_driven_staging, now list_airflow_driven_staging)
[0m23:37:41.707339 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m23:37:41.707963 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m23:37:41.708411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:41.712758 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m23:37:41.713700 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m23:37:41.714624 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m23:37:41.722574 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m23:37:41.726277 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m23:37:41.726970 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m23:37:41.727929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now list_airflow_driven_trusted)
[0m23:37:41.732720 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m23:37:41.733530 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m23:37:41.734653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:41.740021 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m23:37:41.741175 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m23:37:41.742136 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m23:37:41.745919 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m23:37:41.747846 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m23:37:41.748658 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m23:37:41.759317 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:41.759927 [debug] [MainThread]: On master: BEGIN
[0m23:37:41.760586 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:37:41.765216 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:37:41.765853 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:41.766932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:37:41.775853 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m23:37:41.777866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '585c29df-515a-4989-95a9-83d21431ecb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d5ba5820>]}
[0m23:37:41.778537 [debug] [MainThread]: On master: ROLLBACK
[0m23:37:41.779327 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:41.779825 [debug] [MainThread]: On master: BEGIN
[0m23:37:41.780659 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:37:41.781369 [debug] [MainThread]: On master: COMMIT
[0m23:37:41.782173 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:41.782892 [debug] [MainThread]: On master: COMMIT
[0m23:37:41.783734 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:37:41.784695 [debug] [MainThread]: On master: Close
[0m23:37:41.787118 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:37:41.788363 [info ] [MainThread]: 
[0m23:37:41.802894 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_address
[0m23:37:41.804321 [info ] [Thread-1 (]: 1 of 5 START sql table model driven_staging.dim_address ........................ [RUN]
[0m23:37:41.805471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now model.dbt_driven_data.staging_dim_address)
[0m23:37:41.806459 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_address
[0m23:37:41.818145 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_address"
[0m23:37:41.819418 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_address
[0m23:37:41.880675 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_address"
[0m23:37:41.881970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m23:37:41.882512 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: BEGIN
[0m23:37:41.883279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:41.889610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m23:37:41.891437 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m23:37:41.892534 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */

  
    

  create  table "airflow"."driven_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 unique_id,
 address,
 mac_address,
 ip_address
 FROM
 "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m23:37:41.900023 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:37:41.911391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m23:37:41.912045 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m23:37:41.912972 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:37:41.945550 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m23:37:41.946406 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m23:37:41.947360 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m23:37:41.949525 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:37:41.965033 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_address__dbt_backup"
[0m23:37:41.975806 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m23:37:41.976424 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
drop table if exists "airflow"."driven_staging"."dim_address__dbt_backup" cascade
[0m23:37:41.977259 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:37:41.980398 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: Close
[0m23:37:41.982513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '585c29df-515a-4989-95a9-83d21431ecb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d6845610>]}
[0m23:37:41.983587 [info ] [Thread-1 (]: 1 of 5 OK created sql table model driven_staging.dim_address ................... [[32mSELECT 0[0m in 0.18s]
[0m23:37:41.984731 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_address
[0m23:37:41.985485 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_date
[0m23:37:41.986797 [info ] [Thread-1 (]: 2 of 5 START sql table model driven_staging.dim_date ........................... [RUN]
[0m23:37:41.987920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_address, now model.dbt_driven_data.staging_dim_date)
[0m23:37:41.989135 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_date
[0m23:37:41.995104 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_date"
[0m23:37:41.995997 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_date
[0m23:37:42.000806 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_date"
[0m23:37:42.001685 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m23:37:42.002282 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: BEGIN
[0m23:37:42.003168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:42.008736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m23:37:42.010301 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m23:37:42.011768 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */

  
    

  create  table "airflow"."driven_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m23:37:42.015456 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m23:37:42.019611 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m23:37:42.020340 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m23:37:42.022133 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:37:42.025080 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m23:37:42.025711 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m23:37:42.026291 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m23:37:42.028125 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:37:42.031551 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_date__dbt_backup"
[0m23:37:42.033029 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m23:37:42.033667 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
drop table if exists "airflow"."driven_staging"."dim_date__dbt_backup" cascade
[0m23:37:42.034556 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:37:42.037063 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: Close
[0m23:37:42.038676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '585c29df-515a-4989-95a9-83d21431ecb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d3b23ef0>]}
[0m23:37:42.040554 [info ] [Thread-1 (]: 2 of 5 OK created sql table model driven_staging.dim_date ...................... [[32mSELECT 0[0m in 0.05s]
[0m23:37:42.042110 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_date
[0m23:37:42.043027 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_finance
[0m23:37:42.044180 [info ] [Thread-1 (]: 3 of 5 START sql table model driven_staging.dim_finance ........................ [RUN]
[0m23:37:42.045165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_date, now model.dbt_driven_data.staging_dim_finance)
[0m23:37:42.045727 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_finance
[0m23:37:42.049743 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_finance"
[0m23:37:42.050561 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_finance
[0m23:37:42.057865 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_finance"
[0m23:37:42.058746 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m23:37:42.059307 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: BEGIN
[0m23:37:42.059859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:42.064811 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:37:42.066309 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m23:37:42.067543 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */

  
    

  create  table "airflow"."driven_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 unique_id,
 iban
 FROM
 "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m23:37:42.070747 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m23:37:42.076661 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m23:37:42.077578 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m23:37:42.078973 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:37:42.081553 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m23:37:42.082222 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m23:37:42.082848 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m23:37:42.084416 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:37:42.089219 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_finance__dbt_backup"
[0m23:37:42.091141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m23:37:42.091842 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
drop table if exists "airflow"."driven_staging"."dim_finance__dbt_backup" cascade
[0m23:37:42.092774 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:37:42.095041 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: Close
[0m23:37:42.095898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '585c29df-515a-4989-95a9-83d21431ecb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d3b73830>]}
[0m23:37:42.096986 [info ] [Thread-1 (]: 3 of 5 OK created sql table model driven_staging.dim_finance ................... [[32mSELECT 0[0m in 0.05s]
[0m23:37:42.098670 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_finance
[0m23:37:42.099365 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_person
[0m23:37:42.100075 [info ] [Thread-1 (]: 4 of 5 START sql table model driven_staging.dim_person ......................... [RUN]
[0m23:37:42.100808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_finance, now model.dbt_driven_data.staging_dim_person)
[0m23:37:42.101576 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_person
[0m23:37:42.109296 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_person"
[0m23:37:42.110286 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_person
[0m23:37:42.115042 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_person"
[0m23:37:42.115924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m23:37:42.116753 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: BEGIN
[0m23:37:42.117382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:42.123319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m23:37:42.124604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m23:37:42.125706 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */

  
    

  create  table "airflow"."driven_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 unique_id,
 person_name,
 user_name,
 email,
 phone,
 birth_date,
 personal_number
 FROM
 "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m23:37:42.132356 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m23:37:42.136195 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m23:37:42.136823 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m23:37:42.138481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:37:42.141800 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m23:37:42.142365 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m23:37:42.142862 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m23:37:42.144996 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:37:42.148158 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_person__dbt_backup"
[0m23:37:42.149360 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m23:37:42.149914 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
drop table if exists "airflow"."driven_staging"."dim_person__dbt_backup" cascade
[0m23:37:42.150705 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:37:42.153395 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: Close
[0m23:37:42.154911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '585c29df-515a-4989-95a9-83d21431ecb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d3b7e960>]}
[0m23:37:42.156519 [info ] [Thread-1 (]: 4 of 5 OK created sql table model driven_staging.dim_person .................... [[32mSELECT 0[0m in 0.05s]
[0m23:37:42.158358 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_person
[0m23:37:42.159400 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_fact_network_usage
[0m23:37:42.160252 [info ] [Thread-1 (]: 5 of 5 START sql table model driven_staging.fact_network_usage ................. [RUN]
[0m23:37:42.161229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_person, now model.dbt_driven_data.staging_fact_network_usage)
[0m23:37:42.162140 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_fact_network_usage
[0m23:37:42.166147 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_fact_network_usage"
[0m23:37:42.166977 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_fact_network_usage
[0m23:37:42.172336 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_fact_network_usage"
[0m23:37:42.173332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m23:37:42.173891 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: BEGIN
[0m23:37:42.174513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:42.179466 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:37:42.180795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m23:37:42.182130 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."driven_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 unique_id,
 session_duration,
 download_speed,
 upload_speed,
 consumed_traffic
 FROM
 "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m23:37:42.184680 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m23:37:42.190679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m23:37:42.191342 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m23:37:42.192327 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:37:42.195080 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m23:37:42.195681 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m23:37:42.196297 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m23:37:42.198337 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:37:42.201684 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."fact_network_usage__dbt_backup"
[0m23:37:42.203462 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m23:37:42.204666 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
drop table if exists "airflow"."driven_staging"."fact_network_usage__dbt_backup" cascade
[0m23:37:42.206131 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:37:42.208497 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: Close
[0m23:37:42.209650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '585c29df-515a-4989-95a9-83d21431ecb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d43c8860>]}
[0m23:37:42.211797 [info ] [Thread-1 (]: 5 of 5 OK created sql table model driven_staging.fact_network_usage ............ [[32mSELECT 0[0m in 0.05s]
[0m23:37:42.213597 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_fact_network_usage
[0m23:37:42.216362 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:42.217516 [debug] [MainThread]: On master: BEGIN
[0m23:37:42.218386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:37:42.227200 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m23:37:42.229027 [debug] [MainThread]: On master: COMMIT
[0m23:37:42.230795 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:42.232073 [debug] [MainThread]: On master: COMMIT
[0m23:37:42.233984 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:37:42.235385 [debug] [MainThread]: On master: Close
[0m23:37:42.236982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:42.239720 [debug] [MainThread]: Connection 'model.dbt_driven_data.staging_fact_network_usage' was properly closed.
[0m23:37:42.241726 [info ] [MainThread]: 
[0m23:37:42.245337 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m23:37:42.252514 [debug] [MainThread]: Command end result
[0m23:37:42.331641 [info ] [MainThread]: 
[0m23:37:42.332743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:37:42.334648 [info ] [MainThread]: 
[0m23:37:42.336170 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:37:42.339254 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0092275, "process_user_time": 5.946719, "process_kernel_time": 0.525792, "process_mem_max_rss": "119996", "process_in_blocks": "44328", "process_out_blocks": "6008"}
[0m23:37:42.340758 [debug] [MainThread]: Command `dbt run` succeeded at 23:37:42.340445 after 2.01 seconds
[0m23:37:42.342032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d756a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d4f960f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d63dbe00>]}
[0m23:37:42.343249 [debug] [MainThread]: Flushing usage events
[0m23:37:48.165754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0d1803a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0d1801190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0d1803b00>]}


============================== 23:37:48.176313 | f3ff9815-b2c4-4058-b62e-9a8cc8644644 ==============================
[0m23:37:48.176313 [info ] [MainThread]: Running with dbt=1.8.0
[0m23:37:48.177337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:trusted', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:37:48.445107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3ff9815-b2c4-4058-b62e-9a8cc8644644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0d0b843e0>]}
[0m23:37:48.541270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3ff9815-b2c4-4058-b62e-9a8cc8644644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0d4209df0>]}
[0m23:37:48.542590 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:37:48.722056 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m23:37:48.933738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:37:48.934336 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:37:48.995350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3ff9815-b2c4-4058-b62e-9a8cc8644644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0d0372630>]}
[0m23:37:49.169650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3ff9815-b2c4-4058-b62e-9a8cc8644644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0cfb085c0>]}
[0m23:37:49.170668 [info ] [MainThread]: Found 9 models, 7 sources, 428 macros
[0m23:37:49.171405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3ff9815-b2c4-4058-b62e-9a8cc8644644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0d03506b0>]}
[0m23:37:49.175686 [info ] [MainThread]: 
[0m23:37:49.176782 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:37:49.182893 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:37:49.254195 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:37:49.255517 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:37:49.256749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:49.263783 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m23:37:49.265948 [debug] [ThreadPool]: On list_airflow: Close
[0m23:37:49.267070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_driven_trusted)
[0m23:37:49.267799 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "driven_trusted"
"
[0m23:37:49.277002 [debug] [ThreadPool]: Using postgres connection "create_airflow_driven_trusted"
[0m23:37:49.277646 [debug] [ThreadPool]: On create_airflow_driven_trusted: BEGIN
[0m23:37:49.278538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:49.283250 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m23:37:49.284230 [debug] [ThreadPool]: Using postgres connection "create_airflow_driven_trusted"
[0m23:37:49.284844 [debug] [ThreadPool]: On create_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_driven_trusted"} */
create schema if not exists "driven_trusted"
[0m23:37:49.285940 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m23:37:49.287510 [debug] [ThreadPool]: On create_airflow_driven_trusted: COMMIT
[0m23:37:49.288117 [debug] [ThreadPool]: Using postgres connection "create_airflow_driven_trusted"
[0m23:37:49.288645 [debug] [ThreadPool]: On create_airflow_driven_trusted: COMMIT
[0m23:37:49.290801 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m23:37:49.291724 [debug] [ThreadPool]: On create_airflow_driven_trusted: Close
[0m23:37:49.294728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_driven_trusted, now list_airflow_driven_staging)
[0m23:37:49.306227 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m23:37:49.307017 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m23:37:49.307503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:49.312596 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m23:37:49.313332 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m23:37:49.314172 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m23:37:49.319232 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m23:37:49.321277 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m23:37:49.322698 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m23:37:49.324171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now list_airflow_driven_trusted)
[0m23:37:49.329799 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m23:37:49.330461 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m23:37:49.330955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:49.335333 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m23:37:49.336111 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m23:37:49.336625 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m23:37:49.342262 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m23:37:49.345354 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m23:37:49.346046 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m23:37:49.353612 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:49.354517 [debug] [MainThread]: On master: BEGIN
[0m23:37:49.356090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:37:49.361285 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:37:49.362355 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:49.363058 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:37:49.367695 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m23:37:49.369718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3ff9815-b2c4-4058-b62e-9a8cc8644644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0d03733e0>]}
[0m23:37:49.370499 [debug] [MainThread]: On master: ROLLBACK
[0m23:37:49.371594 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:49.372664 [debug] [MainThread]: On master: BEGIN
[0m23:37:49.374639 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:37:49.375435 [debug] [MainThread]: On master: COMMIT
[0m23:37:49.376176 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:49.377078 [debug] [MainThread]: On master: COMMIT
[0m23:37:49.378146 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:37:49.378843 [debug] [MainThread]: On master: Close
[0m23:37:49.379666 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:37:49.380740 [info ] [MainThread]: 
[0m23:37:49.398044 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_non_pii_data
[0m23:37:49.398952 [info ] [Thread-1 (]: 1 of 4 START sql table model driven_trusted.non_pii_data ....................... [RUN]
[0m23:37:49.399700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now model.dbt_driven_data.trusted_non_pii_data)
[0m23:37:49.400644 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_non_pii_data
[0m23:37:49.415372 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_non_pii_data"
[0m23:37:49.416298 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_non_pii_data
[0m23:37:49.479738 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_non_pii_data"
[0m23:37:49.480795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m23:37:49.481602 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: BEGIN
[0m23:37:49.482167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:49.487022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:37:49.488206 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m23:37:49.489964 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 '***MASKED***' AS person_name,
 SUBSTRING(dp.user_name, 1, 5) || '*****' user_name,
 SUBSTRING(dp.email, 1, 5) || '*****' AS email,
 '***MASKED***' AS personal_number,
 '***MASKED***' AS birth_date,
 '***MASKED***' AS address,
 '***MASKED***' AS phone,
 SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
 SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
 SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
 dd.accessed_at,
 fnu.session_duration,
 fnu.download_speed,
 fnu.upload_speed,
 fnu.consumed_traffic,
 fnu.unique_id
 FROM
 "airflow"."driven_staging"."fact_network_usage" fnu
 INNER JOIN
 "airflow"."driven_staging"."dim_address" da ON
fnu.unique_id = da.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_date" dd ON da.unique_id =
dd.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_finance" df ON dd.unique_id
= df.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_person" dp ON df.unique_id
= dp.unique_id
)
SELECT
 *
FROM
 source_data
  );
  
[0m23:37:49.498665 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m23:37:49.508648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m23:37:49.509248 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m23:37:49.510253 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:37:49.536183 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m23:37:49.536954 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m23:37:49.537858 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m23:37:49.540523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:37:49.550065 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."non_pii_data__dbt_backup"
[0m23:37:49.559328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m23:37:49.559967 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
drop table if exists "airflow"."driven_trusted"."non_pii_data__dbt_backup" cascade
[0m23:37:49.561063 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:37:49.564994 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: Close
[0m23:37:49.568291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3ff9815-b2c4-4058-b62e-9a8cc8644644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0d24d9b50>]}
[0m23:37:49.569522 [info ] [Thread-1 (]: 1 of 4 OK created sql table model driven_trusted.non_pii_data .................. [[32mSELECT 0[0m in 0.17s]
[0m23:37:49.570791 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_non_pii_data
[0m23:37:49.572076 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_payment_data
[0m23:37:49.573448 [info ] [Thread-1 (]: 2 of 4 START sql table model driven_trusted.payment_data ....................... [RUN]
[0m23:37:49.574349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_non_pii_data, now model.dbt_driven_data.trusted_payment_data)
[0m23:37:49.574987 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_payment_data
[0m23:37:49.579828 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_payment_data"
[0m23:37:49.580692 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_payment_data
[0m23:37:49.585328 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_payment_data"
[0m23:37:49.586168 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m23:37:49.586835 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: BEGIN
[0m23:37:49.587590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:49.593155 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:37:49.595124 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m23:37:49.596024 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */

  
    

  create  table "airflow"."driven_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 fnu.unique_id,
 df.iban,
 fnu.download_speed,
 fnu.upload_speed,
 fnu.session_duration,
 fnu.consumed_traffic,
 ((fnu.download_speed + fnu.upload_speed + 1)/2) +
(fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
 FROM
 "airflow"."driven_staging"."fact_network_usage" fnu
 JOIN
 "airflow"."driven_staging"."dim_finance" df
 ON
 fnu.unique_id = df.unique_id
)
SELECT
 *
FROM
 source_data
  );
  
[0m23:37:49.599096 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m23:37:49.603187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m23:37:49.604072 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m23:37:49.605944 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:37:49.608850 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m23:37:49.609507 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m23:37:49.610084 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m23:37:49.612059 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:37:49.615424 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."payment_data__dbt_backup"
[0m23:37:49.616619 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m23:37:49.617171 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
drop table if exists "airflow"."driven_trusted"."payment_data__dbt_backup" cascade
[0m23:37:49.618171 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:37:49.620032 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: Close
[0m23:37:49.621035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3ff9815-b2c4-4058-b62e-9a8cc8644644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0cdf84b60>]}
[0m23:37:49.622575 [info ] [Thread-1 (]: 2 of 4 OK created sql table model driven_trusted.payment_data .................. [[32mSELECT 0[0m in 0.05s]
[0m23:37:49.624437 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_payment_data
[0m23:37:49.625137 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_pii_data
[0m23:37:49.626136 [info ] [Thread-1 (]: 3 of 4 START sql table model driven_trusted.pii_data ........................... [RUN]
[0m23:37:49.627136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_payment_data, now model.dbt_driven_data.trusted_pii_data)
[0m23:37:49.627870 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_pii_data
[0m23:37:49.634504 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_pii_data"
[0m23:37:49.635925 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_pii_data
[0m23:37:49.647908 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_pii_data"
[0m23:37:49.649616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m23:37:49.650823 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: BEGIN
[0m23:37:49.652004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:49.664143 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:37:49.665269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m23:37:49.666415 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 dp.person_name,
 dp.user_name,
 dp.email,
 dp.personal_number,
 dp.birth_date,
 da.address,
 dp.phone,
 da.mac_address,
 da.ip_address,
 df.iban,
 dd.accessed_at,
 fnu.session_duration,
 fnu.download_speed,
 fnu.upload_speed,
 fnu.consumed_traffic,
 fnu.unique_id
 FROM
 "airflow"."driven_staging"."fact_network_usage" fnu
 INNER JOIN
 "airflow"."driven_staging"."dim_address" da ON
fnu.unique_id = da.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_date" dd ON da.unique_id =
dd.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_finance" df ON dd.unique_id
= df.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_person" dp ON df.unique_id
= dp.unique_id
)
SELECT
 *
FROM
 source_data
  );
  
[0m23:37:49.680403 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.012 seconds
[0m23:37:49.688645 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m23:37:49.690281 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m23:37:49.692954 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:37:49.698287 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m23:37:49.699282 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m23:37:49.700011 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m23:37:49.701922 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:37:49.710317 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."pii_data__dbt_backup"
[0m23:37:49.712330 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m23:37:49.713270 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
drop table if exists "airflow"."driven_trusted"."pii_data__dbt_backup" cascade
[0m23:37:49.715480 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:37:49.719608 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: Close
[0m23:37:49.720669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3ff9815-b2c4-4058-b62e-9a8cc8644644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0cc618ec0>]}
[0m23:37:49.722590 [info ] [Thread-1 (]: 3 of 4 OK created sql table model driven_trusted.pii_data ...................... [[32mSELECT 0[0m in 0.09s]
[0m23:37:49.726350 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_pii_data
[0m23:37:49.728427 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_technical_data
[0m23:37:49.730375 [info ] [Thread-1 (]: 4 of 4 START sql table model driven_trusted.technical_data ..................... [RUN]
[0m23:37:49.732080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_pii_data, now model.dbt_driven_data.trusted_technical_data)
[0m23:37:49.733195 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_technical_data
[0m23:37:49.741016 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_technical_data"
[0m23:37:49.742189 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_technical_data
[0m23:37:49.754517 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_technical_data"
[0m23:37:49.756270 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m23:37:49.757575 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: BEGIN
[0m23:37:49.758772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:49.766350 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:37:49.767402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m23:37:49.768752 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */

  
    

  create  table "airflow"."driven_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 fnu.unique_id,
 da.address,
 da.mac_address,
 da.ip_address,
 fnu.download_speed,
 fnu.upload_speed,
 ROUND((fnu.session_duration/60), 1) as min_session_duration,
 CASE
WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR
fnu.session_duration/60 < 1 THEN true
 ELSE false
 END AS technical_issue
 FROM
 "airflow"."driven_staging"."fact_network_usage" fnu
 JOIN
 "airflow"."driven_staging"."dim_address" da
 ON
 fnu.unique_id = da.unique_id
)
SELECT
 *
FROM
 source_data
  );
  
[0m23:37:49.781059 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.011 seconds
[0m23:37:49.788012 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m23:37:49.789391 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m23:37:49.791159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:37:49.796352 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m23:37:49.797568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m23:37:49.798344 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m23:37:49.800228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:37:49.803444 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."technical_data__dbt_backup"
[0m23:37:49.805723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m23:37:49.806514 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
drop table if exists "airflow"."driven_trusted"."technical_data__dbt_backup" cascade
[0m23:37:49.807653 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:37:49.809561 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: Close
[0m23:37:49.810771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3ff9815-b2c4-4058-b62e-9a8cc8644644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0cdf87380>]}
[0m23:37:49.812035 [info ] [Thread-1 (]: 4 of 4 OK created sql table model driven_trusted.technical_data ................ [[32mSELECT 0[0m in 0.08s]
[0m23:37:49.813453 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_technical_data
[0m23:37:49.815854 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:49.816825 [debug] [MainThread]: On master: BEGIN
[0m23:37:49.817337 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:37:49.822464 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:37:49.824133 [debug] [MainThread]: On master: COMMIT
[0m23:37:49.825693 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:49.826707 [debug] [MainThread]: On master: COMMIT
[0m23:37:49.828217 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:37:49.828960 [debug] [MainThread]: On master: Close
[0m23:37:49.830322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:49.831612 [debug] [MainThread]: Connection 'model.dbt_driven_data.trusted_technical_data' was properly closed.
[0m23:37:49.832998 [info ] [MainThread]: 
[0m23:37:49.834064 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m23:37:49.836646 [debug] [MainThread]: Command end result
[0m23:37:49.901981 [info ] [MainThread]: 
[0m23:37:49.902647 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:37:49.903496 [info ] [MainThread]: 
[0m23:37:49.904538 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:37:49.906959 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8616122, "process_user_time": 4.55785, "process_kernel_time": 0.351371, "process_mem_max_rss": "119536", "process_in_blocks": "1872", "process_out_blocks": "1928"}
[0m23:37:49.908188 [debug] [MainThread]: Command `dbt run` succeeded at 23:37:49.907997 after 1.86 seconds
[0m23:37:49.908761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0d0c1fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0d127c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0cc623c20>]}
[0m23:37:49.909402 [debug] [MainThread]: Flushing usage events
[0m18:10:11.436103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca26fe5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca263e1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca24ba3f20>]}


============================== 18:10:11.471745 | 0b6bd164-b5bb-4535-8000-aa80b910abd1 ==============================
[0m18:10:11.471745 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:10:11.473184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:10:11.775876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b6bd164-b5bb-4535-8000-aa80b910abd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca25604590>]}
[0m18:10:11.885525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b6bd164-b5bb-4535-8000-aa80b910abd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca24399370>]}
[0m18:10:11.893585 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:10:12.106886 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:10:12.319679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:12.320363 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:12.395949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b6bd164-b5bb-4535-8000-aa80b910abd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca242312e0>]}
[0m18:10:12.577507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b6bd164-b5bb-4535-8000-aa80b910abd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca241a9a90>]}
[0m18:10:12.578336 [info ] [MainThread]: Found 9 models, 7 sources, 428 macros
[0m18:10:12.579010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b6bd164-b5bb-4535-8000-aa80b910abd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca243ded80>]}
[0m18:10:12.582214 [info ] [MainThread]: 
[0m18:10:12.583267 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:10:12.593069 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m18:10:12.667787 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m18:10:12.668336 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m18:10:12.668763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:12.676446 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m18:10:12.679925 [debug] [ThreadPool]: On list_airflow: Close
[0m18:10:12.684497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_trusted)
[0m18:10:12.695249 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m18:10:12.695767 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m18:10:12.696192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:12.700924 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:10:12.701892 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m18:10:12.702375 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m18:10:12.708809 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m18:10:12.711798 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m18:10:12.712492 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m18:10:12.713748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now list_airflow_driven_staging)
[0m18:10:12.718423 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m18:10:12.718923 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m18:10:12.719338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:12.724986 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m18:10:12.725992 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m18:10:12.727001 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m18:10:12.731367 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m18:10:12.733177 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m18:10:12.733853 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m18:10:12.748794 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:12.749729 [debug] [MainThread]: On master: BEGIN
[0m18:10:12.750604 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:12.757190 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:10:12.758161 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:12.758781 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:10:12.765709 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m18:10:12.769094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b6bd164-b5bb-4535-8000-aa80b910abd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca2255e990>]}
[0m18:10:12.770241 [debug] [MainThread]: On master: ROLLBACK
[0m18:10:12.771689 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:12.772708 [debug] [MainThread]: On master: BEGIN
[0m18:10:12.773940 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:10:12.774902 [debug] [MainThread]: On master: COMMIT
[0m18:10:12.775867 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:12.776890 [debug] [MainThread]: On master: COMMIT
[0m18:10:12.778034 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:10:12.778917 [debug] [MainThread]: On master: Close
[0m18:10:12.780146 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:12.781157 [info ] [MainThread]: 
[0m18:10:12.797230 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_address
[0m18:10:12.798517 [info ] [Thread-1 (]: 1 of 5 START sql table model driven_staging.dim_address ........................ [RUN]
[0m18:10:12.799631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now model.dbt_driven_data.staging_dim_address)
[0m18:10:12.800277 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_address
[0m18:10:12.812407 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_address"
[0m18:10:12.813645 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_address
[0m18:10:12.875878 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_address"
[0m18:10:12.877277 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m18:10:12.877854 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: BEGIN
[0m18:10:12.878340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:12.885096 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:10:12.886520 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m18:10:12.888251 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */

  
    

  create  table "airflow"."driven_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 unique_id,
 address,
 mac_address,
 ip_address
 FROM
 "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m18:10:12.896642 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m18:10:12.906250 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m18:10:12.907357 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m18:10:12.908743 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:12.914588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m18:10:12.915154 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m18:10:12.916057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:12.946395 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m18:10:12.947191 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m18:10:12.947680 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m18:10:12.949569 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:10:12.959502 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_address__dbt_backup"
[0m18:10:12.967142 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m18:10:12.967779 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
drop table if exists "airflow"."driven_staging"."dim_address__dbt_backup" cascade
[0m18:10:12.971160 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:10:12.975561 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: Close
[0m18:10:12.977905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b6bd164-b5bb-4535-8000-aa80b910abd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca25d66c00>]}
[0m18:10:12.978942 [info ] [Thread-1 (]: 1 of 5 OK created sql table model driven_staging.dim_address ................... [[32mSELECT 0[0m in 0.18s]
[0m18:10:12.980336 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_address
[0m18:10:12.980984 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_date
[0m18:10:12.981620 [info ] [Thread-1 (]: 2 of 5 START sql table model driven_staging.dim_date ........................... [RUN]
[0m18:10:12.982439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_address, now model.dbt_driven_data.staging_dim_date)
[0m18:10:12.982972 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_date
[0m18:10:12.988102 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_date"
[0m18:10:12.989580 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_date
[0m18:10:12.995034 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_date"
[0m18:10:12.995863 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m18:10:12.996386 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: BEGIN
[0m18:10:12.997270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:13.002029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m18:10:13.003163 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m18:10:13.004240 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */

  
    

  create  table "airflow"."driven_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m18:10:13.007281 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m18:10:13.011598 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m18:10:13.012187 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m18:10:13.013201 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:13.017057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m18:10:13.017584 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m18:10:13.018517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:13.022298 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m18:10:13.023242 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m18:10:13.024098 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m18:10:13.026300 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:10:13.029569 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_date__dbt_backup"
[0m18:10:13.030684 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m18:10:13.031227 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
drop table if exists "airflow"."driven_staging"."dim_date__dbt_backup" cascade
[0m18:10:13.033528 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:10:13.035383 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: Close
[0m18:10:13.036396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b6bd164-b5bb-4535-8000-aa80b910abd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca2257ce00>]}
[0m18:10:13.038422 [info ] [Thread-1 (]: 2 of 5 OK created sql table model driven_staging.dim_date ...................... [[32mSELECT 0[0m in 0.05s]
[0m18:10:13.040430 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_date
[0m18:10:13.041550 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_finance
[0m18:10:13.042691 [info ] [Thread-1 (]: 3 of 5 START sql table model driven_staging.dim_finance ........................ [RUN]
[0m18:10:13.043555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_date, now model.dbt_driven_data.staging_dim_finance)
[0m18:10:13.044189 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_finance
[0m18:10:13.048357 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_finance"
[0m18:10:13.049162 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_finance
[0m18:10:13.053999 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_finance"
[0m18:10:13.055595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m18:10:13.056707 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: BEGIN
[0m18:10:13.058097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:13.063993 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:10:13.064620 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m18:10:13.065527 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */

  
    

  create  table "airflow"."driven_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 unique_id,
 iban
 FROM
 "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m18:10:13.067953 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m18:10:13.073384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m18:10:13.074245 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m18:10:13.075252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:13.082887 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m18:10:13.083897 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m18:10:13.085013 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:13.092141 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m18:10:13.092989 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m18:10:13.094133 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m18:10:13.096120 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:10:13.099535 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_finance__dbt_backup"
[0m18:10:13.100585 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m18:10:13.101095 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
drop table if exists "airflow"."driven_staging"."dim_finance__dbt_backup" cascade
[0m18:10:13.103317 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:10:13.106834 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: Close
[0m18:10:13.108188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b6bd164-b5bb-4535-8000-aa80b910abd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca221ae330>]}
[0m18:10:13.110150 [info ] [Thread-1 (]: 3 of 5 OK created sql table model driven_staging.dim_finance ................... [[32mSELECT 0[0m in 0.06s]
[0m18:10:13.111546 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_finance
[0m18:10:13.112162 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_person
[0m18:10:13.112786 [info ] [Thread-1 (]: 4 of 5 START sql table model driven_staging.dim_person ......................... [RUN]
[0m18:10:13.113671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_finance, now model.dbt_driven_data.staging_dim_person)
[0m18:10:13.114300 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_person
[0m18:10:13.120090 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_person"
[0m18:10:13.121464 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_person
[0m18:10:13.128619 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_person"
[0m18:10:13.129467 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m18:10:13.130272 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: BEGIN
[0m18:10:13.130748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:13.135697 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m18:10:13.136398 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m18:10:13.137001 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */

  
    

  create  table "airflow"."driven_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 unique_id,
 person_name,
 user_name,
 email,
 phone,
 birth_date,
 personal_number
 FROM
 "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m18:10:13.143863 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m18:10:13.147776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m18:10:13.148332 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m18:10:13.149275 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:13.153231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m18:10:13.153882 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m18:10:13.155467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:10:13.158982 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m18:10:13.159677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m18:10:13.160413 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m18:10:13.162319 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:10:13.165543 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_person__dbt_backup"
[0m18:10:13.166598 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m18:10:13.167153 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
drop table if exists "airflow"."driven_staging"."dim_person__dbt_backup" cascade
[0m18:10:13.170390 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:10:13.173434 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: Close
[0m18:10:13.174487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b6bd164-b5bb-4535-8000-aa80b910abd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca221af260>]}
[0m18:10:13.175384 [info ] [Thread-1 (]: 4 of 5 OK created sql table model driven_staging.dim_person .................... [[32mSELECT 0[0m in 0.06s]
[0m18:10:13.176959 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_person
[0m18:10:13.177865 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_fact_network_usage
[0m18:10:13.178653 [info ] [Thread-1 (]: 5 of 5 START sql table model driven_staging.fact_network_usage ................. [RUN]
[0m18:10:13.179517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_person, now model.dbt_driven_data.staging_fact_network_usage)
[0m18:10:13.180274 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_fact_network_usage
[0m18:10:13.184392 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_fact_network_usage"
[0m18:10:13.185215 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_fact_network_usage
[0m18:10:13.193275 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_fact_network_usage"
[0m18:10:13.194237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m18:10:13.194793 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: BEGIN
[0m18:10:13.195299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:13.200058 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m18:10:13.201003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m18:10:13.201514 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."driven_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 unique_id,
 session_duration,
 download_speed,
 upload_speed,
 consumed_traffic
 FROM
 "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m18:10:13.203834 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m18:10:13.210119 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m18:10:13.210697 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m18:10:13.211634 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:13.215544 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m18:10:13.216101 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m18:10:13.216951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:13.219368 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m18:10:13.219995 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m18:10:13.220921 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m18:10:13.223248 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:10:13.227032 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."fact_network_usage__dbt_backup"
[0m18:10:13.228166 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m18:10:13.228668 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
drop table if exists "airflow"."driven_staging"."fact_network_usage__dbt_backup" cascade
[0m18:10:13.231018 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:10:13.232876 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: Close
[0m18:10:13.233667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b6bd164-b5bb-4535-8000-aa80b910abd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca221c7f80>]}
[0m18:10:13.234515 [info ] [Thread-1 (]: 5 of 5 OK created sql table model driven_staging.fact_network_usage ............ [[32mSELECT 0[0m in 0.05s]
[0m18:10:13.235621 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_fact_network_usage
[0m18:10:13.237892 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:13.239088 [debug] [MainThread]: On master: BEGIN
[0m18:10:13.240081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:13.245217 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:10:13.246098 [debug] [MainThread]: On master: COMMIT
[0m18:10:13.246792 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:13.247298 [debug] [MainThread]: On master: COMMIT
[0m18:10:13.247962 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:10:13.248533 [debug] [MainThread]: On master: Close
[0m18:10:13.249343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:13.250290 [debug] [MainThread]: Connection 'model.dbt_driven_data.staging_fact_network_usage' was properly closed.
[0m18:10:13.251555 [info ] [MainThread]: 
[0m18:10:13.252442 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m18:10:13.256342 [debug] [MainThread]: Command end result
[0m18:10:13.301113 [info ] [MainThread]: 
[0m18:10:13.301889 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:13.302629 [info ] [MainThread]: 
[0m18:10:13.303527 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:10:13.305777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9994763, "process_user_time": 5.03121, "process_kernel_time": 0.45566, "process_mem_max_rss": "120264", "process_in_blocks": "36928", "process_out_blocks": "6000"}
[0m18:10:13.307230 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:13.306991 after 2.00 seconds
[0m18:10:13.308267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca24c8f920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca25097a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eca2645bd70>]}
[0m18:10:13.309217 [debug] [MainThread]: Flushing usage events
[0m18:10:21.201613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d22ded4be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d22ddd8f6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d22dd939d00>]}


============================== 18:10:21.210129 | 62566fc1-9d08-45fc-95a7-478ee1926adb ==============================
[0m18:10:21.210129 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:10:21.210822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:trusted', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:10:21.479909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62566fc1-9d08-45fc-95a7-478ee1926adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d22deb9efc0>]}
[0m18:10:21.583670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62566fc1-9d08-45fc-95a7-478ee1926adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d22ddf26960>]}
[0m18:10:21.585514 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:10:21.810326 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:10:22.022632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:22.023300 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:22.076344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62566fc1-9d08-45fc-95a7-478ee1926adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d22dc954e00>]}
[0m18:10:22.221848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62566fc1-9d08-45fc-95a7-478ee1926adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d22dc12c1a0>]}
[0m18:10:22.222566 [info ] [MainThread]: Found 9 models, 7 sources, 428 macros
[0m18:10:22.223291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62566fc1-9d08-45fc-95a7-478ee1926adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d22dd1f3aa0>]}
[0m18:10:22.225992 [info ] [MainThread]: 
[0m18:10:22.226883 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:10:22.232794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m18:10:22.299622 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m18:10:22.300493 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m18:10:22.301736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:22.308949 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m18:10:22.310774 [debug] [ThreadPool]: On list_airflow: Close
[0m18:10:22.314348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_staging)
[0m18:10:22.325789 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m18:10:22.326749 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m18:10:22.327329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:22.332332 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:10:22.333244 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m18:10:22.334149 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m18:10:22.339407 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m18:10:22.341639 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m18:10:22.342381 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m18:10:22.343429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now list_airflow_driven_trusted)
[0m18:10:22.347850 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m18:10:22.348324 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m18:10:22.348722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:22.354139 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:10:22.355038 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m18:10:22.355499 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m18:10:22.359441 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m18:10:22.361267 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m18:10:22.361957 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m18:10:22.371470 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:22.372051 [debug] [MainThread]: On master: BEGIN
[0m18:10:22.372549 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:22.377236 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:10:22.377893 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:22.378578 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:10:22.382924 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m18:10:22.386053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62566fc1-9d08-45fc-95a7-478ee1926adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d22dbd6bc50>]}
[0m18:10:22.387248 [debug] [MainThread]: On master: ROLLBACK
[0m18:10:22.387968 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:22.388469 [debug] [MainThread]: On master: BEGIN
[0m18:10:22.389271 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:10:22.390039 [debug] [MainThread]: On master: COMMIT
[0m18:10:22.390658 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:22.391182 [debug] [MainThread]: On master: COMMIT
[0m18:10:22.391806 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:10:22.392327 [debug] [MainThread]: On master: Close
[0m18:10:22.393191 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:22.394251 [info ] [MainThread]: 
[0m18:10:22.409257 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_non_pii_data
[0m18:10:22.410561 [info ] [Thread-1 (]: 1 of 4 START sql table model driven_trusted.non_pii_data ....................... [RUN]
[0m18:10:22.411654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now model.dbt_driven_data.trusted_non_pii_data)
[0m18:10:22.412714 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_non_pii_data
[0m18:10:22.427179 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_non_pii_data"
[0m18:10:22.428019 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_non_pii_data
[0m18:10:22.487103 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_non_pii_data"
[0m18:10:22.488003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m18:10:22.488492 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: BEGIN
[0m18:10:22.488986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:22.493937 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m18:10:22.495067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m18:10:22.496003 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 '***MASKED***' AS person_name,
 SUBSTRING(dp.user_name, 1, 5) || '*****' user_name,
 SUBSTRING(dp.email, 1, 5) || '*****' AS email,
 '***MASKED***' AS personal_number,
 '***MASKED***' AS birth_date,
 '***MASKED***' AS address,
 '***MASKED***' AS phone,
 SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
 SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
 SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
 dd.accessed_at,
 fnu.session_duration,
 fnu.download_speed,
 fnu.upload_speed,
 fnu.consumed_traffic,
 fnu.unique_id
 FROM
 "airflow"."driven_staging"."fact_network_usage" fnu
 INNER JOIN
 "airflow"."driven_staging"."dim_address" da ON
fnu.unique_id = da.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_date" dd ON da.unique_id =
dd.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_finance" df ON dd.unique_id
= df.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_person" dp ON df.unique_id
= dp.unique_id
)
SELECT
 *
FROM
 source_data
  );
  
[0m18:10:22.503641 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m18:10:22.515171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m18:10:22.515740 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m18:10:22.516787 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:22.522541 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m18:10:22.523166 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m18:10:22.524328 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:22.556019 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m18:10:22.556607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m18:10:22.557297 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m18:10:22.559166 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:10:22.569572 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."non_pii_data__dbt_backup"
[0m18:10:22.578325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m18:10:22.578919 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
drop table if exists "airflow"."driven_trusted"."non_pii_data__dbt_backup" cascade
[0m18:10:22.581561 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:10:22.584807 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: Close
[0m18:10:22.587862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62566fc1-9d08-45fc-95a7-478ee1926adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d22ddec3c80>]}
[0m18:10:22.588925 [info ] [Thread-1 (]: 1 of 4 OK created sql table model driven_trusted.non_pii_data .................. [[32mSELECT 0[0m in 0.17s]
[0m18:10:22.590210 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_non_pii_data
[0m18:10:22.591368 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_payment_data
[0m18:10:22.592596 [info ] [Thread-1 (]: 2 of 4 START sql table model driven_trusted.payment_data ....................... [RUN]
[0m18:10:22.593778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_non_pii_data, now model.dbt_driven_data.trusted_payment_data)
[0m18:10:22.594387 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_payment_data
[0m18:10:22.598874 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_payment_data"
[0m18:10:22.599681 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_payment_data
[0m18:10:22.606027 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_payment_data"
[0m18:10:22.606948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m18:10:22.607620 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: BEGIN
[0m18:10:22.608292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:22.613677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m18:10:22.614421 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m18:10:22.615243 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */

  
    

  create  table "airflow"."driven_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 fnu.unique_id,
 df.iban,
 fnu.download_speed,
 fnu.upload_speed,
 fnu.session_duration,
 fnu.consumed_traffic,
 ((fnu.download_speed + fnu.upload_speed + 1)/2) +
(fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
 FROM
 "airflow"."driven_staging"."fact_network_usage" fnu
 JOIN
 "airflow"."driven_staging"."dim_finance" df
 ON
 fnu.unique_id = df.unique_id
)
SELECT
 *
FROM
 source_data
  );
  
[0m18:10:22.618234 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m18:10:22.624893 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m18:10:22.625624 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m18:10:22.626694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:22.631016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m18:10:22.631607 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m18:10:22.632464 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:22.636559 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m18:10:22.637640 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m18:10:22.638616 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m18:10:22.640190 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:10:22.643939 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."payment_data__dbt_backup"
[0m18:10:22.645443 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m18:10:22.646060 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
drop table if exists "airflow"."driven_trusted"."payment_data__dbt_backup" cascade
[0m18:10:22.648387 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:10:22.650462 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: Close
[0m18:10:22.651711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62566fc1-9d08-45fc-95a7-478ee1926adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d22da513710>]}
[0m18:10:22.653702 [info ] [Thread-1 (]: 2 of 4 OK created sql table model driven_trusted.payment_data .................. [[32mSELECT 0[0m in 0.06s]
[0m18:10:22.655393 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_payment_data
[0m18:10:22.656540 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_pii_data
[0m18:10:22.658090 [info ] [Thread-1 (]: 3 of 4 START sql table model driven_trusted.pii_data ........................... [RUN]
[0m18:10:22.659244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_payment_data, now model.dbt_driven_data.trusted_pii_data)
[0m18:10:22.659916 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_pii_data
[0m18:10:22.666266 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_pii_data"
[0m18:10:22.667160 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_pii_data
[0m18:10:22.674996 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_pii_data"
[0m18:10:22.675999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m18:10:22.676547 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: BEGIN
[0m18:10:22.677021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:22.682068 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m18:10:22.683114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m18:10:22.684290 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 dp.person_name,
 dp.user_name,
 dp.email,
 dp.personal_number,
 dp.birth_date,
 da.address,
 dp.phone,
 da.mac_address,
 da.ip_address,
 df.iban,
 dd.accessed_at,
 fnu.session_duration,
 fnu.download_speed,
 fnu.upload_speed,
 fnu.consumed_traffic,
 fnu.unique_id
 FROM
 "airflow"."driven_staging"."fact_network_usage" fnu
 INNER JOIN
 "airflow"."driven_staging"."dim_address" da ON
fnu.unique_id = da.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_date" dd ON da.unique_id =
dd.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_finance" df ON dd.unique_id
= df.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_person" dp ON df.unique_id
= dp.unique_id
)
SELECT
 *
FROM
 source_data
  );
  
[0m18:10:22.692943 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m18:10:22.697190 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m18:10:22.698200 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m18:10:22.702357 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:22.709007 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m18:10:22.709910 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m18:10:22.711103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:22.715615 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m18:10:22.716454 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m18:10:22.717251 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m18:10:22.719323 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:10:22.724933 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."pii_data__dbt_backup"
[0m18:10:22.726670 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m18:10:22.727501 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
drop table if exists "airflow"."driven_trusted"."pii_data__dbt_backup" cascade
[0m18:10:22.730468 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:10:22.733330 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: Close
[0m18:10:22.734496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62566fc1-9d08-45fc-95a7-478ee1926adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d22d8c3bd40>]}
[0m18:10:22.735913 [info ] [Thread-1 (]: 3 of 4 OK created sql table model driven_trusted.pii_data ...................... [[32mSELECT 0[0m in 0.08s]
[0m18:10:22.737554 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_pii_data
[0m18:10:22.738700 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_technical_data
[0m18:10:22.740604 [info ] [Thread-1 (]: 4 of 4 START sql table model driven_trusted.technical_data ..................... [RUN]
[0m18:10:22.742484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_pii_data, now model.dbt_driven_data.trusted_technical_data)
[0m18:10:22.743387 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_technical_data
[0m18:10:22.750405 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_technical_data"
[0m18:10:22.751714 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_technical_data
[0m18:10:22.758667 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_technical_data"
[0m18:10:22.759600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m18:10:22.760173 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: BEGIN
[0m18:10:22.760645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:22.765207 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m18:10:22.765796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m18:10:22.766346 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */

  
    

  create  table "airflow"."driven_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 fnu.unique_id,
 da.address,
 da.mac_address,
 da.ip_address,
 fnu.download_speed,
 fnu.upload_speed,
 ROUND((fnu.session_duration/60), 1) as min_session_duration,
 CASE
WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR
fnu.session_duration/60 < 1 THEN true
 ELSE false
 END AS technical_issue
 FROM
 "airflow"."driven_staging"."fact_network_usage" fnu
 JOIN
 "airflow"."driven_staging"."dim_address" da
 ON
 fnu.unique_id = da.unique_id
)
SELECT
 *
FROM
 source_data
  );
  
[0m18:10:22.773850 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m18:10:22.778048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m18:10:22.778861 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m18:10:22.780142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:22.785342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m18:10:22.786540 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m18:10:22.788024 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:22.790659 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m18:10:22.791395 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m18:10:22.791993 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m18:10:22.793683 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:10:22.796782 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."technical_data__dbt_backup"
[0m18:10:22.797801 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m18:10:22.798323 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
drop table if exists "airflow"."driven_trusted"."technical_data__dbt_backup" cascade
[0m18:10:22.801075 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:10:22.804120 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: Close
[0m18:10:22.805384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62566fc1-9d08-45fc-95a7-478ee1926adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d22d8c4d220>]}
[0m18:10:22.806261 [info ] [Thread-1 (]: 4 of 4 OK created sql table model driven_trusted.technical_data ................ [[32mSELECT 0[0m in 0.06s]
[0m18:10:22.807310 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_technical_data
[0m18:10:22.809156 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:22.809707 [debug] [MainThread]: On master: BEGIN
[0m18:10:22.810175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:22.814530 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m18:10:22.815545 [debug] [MainThread]: On master: COMMIT
[0m18:10:22.816161 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:22.816615 [debug] [MainThread]: On master: COMMIT
[0m18:10:22.817251 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:10:22.817833 [debug] [MainThread]: On master: Close
[0m18:10:22.819040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:22.820298 [debug] [MainThread]: Connection 'model.dbt_driven_data.trusted_technical_data' was properly closed.
[0m18:10:22.821740 [info ] [MainThread]: 
[0m18:10:22.822457 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m18:10:22.824275 [debug] [MainThread]: Command end result
[0m18:10:22.871249 [info ] [MainThread]: 
[0m18:10:22.872230 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:22.873147 [info ] [MainThread]: 
[0m18:10:22.874123 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:10:22.875465 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8001169, "process_user_time": 5.28041, "process_kernel_time": 0.424177, "process_mem_max_rss": "119684", "process_out_blocks": "1928", "process_in_blocks": "0"}
[0m18:10:22.876250 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:22.876100 after 1.80 seconds
[0m18:10:22.876794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d22dd6c9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d22de325760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d22dbd71ee0>]}
[0m18:10:22.877359 [debug] [MainThread]: Flushing usage events
[0m19:09:01.182967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78983f9b6f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78983f9650a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78983f9eefc0>]}


============================== 19:09:01.218463 | 5fd7d98c-ff04-4184-9d59-eb3ac7746d33 ==============================
[0m19:09:01.218463 [info ] [MainThread]: Running with dbt=1.8.0
[0m19:09:01.219480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:09:01.534204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fd7d98c-ff04-4184-9d59-eb3ac7746d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78983f7ec8c0>]}
[0m19:09:01.641594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fd7d98c-ff04-4184-9d59-eb3ac7746d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78983f1f9bb0>]}
[0m19:09:01.642993 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:09:01.832830 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m19:09:02.051155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:09:02.051836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:09:02.123951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fd7d98c-ff04-4184-9d59-eb3ac7746d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78983f1e3890>]}
[0m19:09:02.287638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fd7d98c-ff04-4184-9d59-eb3ac7746d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78983f1857c0>]}
[0m19:09:02.288535 [info ] [MainThread]: Found 9 models, 7 sources, 428 macros
[0m19:09:02.289428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fd7d98c-ff04-4184-9d59-eb3ac7746d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78983f9b5040>]}
[0m19:09:02.292323 [info ] [MainThread]: 
[0m19:09:02.293345 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:09:02.301381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m19:09:02.369370 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m19:09:02.369936 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m19:09:02.370372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:02.376560 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m19:09:02.379369 [debug] [ThreadPool]: On list_airflow: Close
[0m19:09:02.384059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_trusted)
[0m19:09:02.392240 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m19:09:02.392769 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m19:09:02.393218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:09:02.398573 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m19:09:02.399289 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m19:09:02.400135 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m19:09:02.406989 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m19:09:02.409695 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m19:09:02.410454 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m19:09:02.411337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now list_airflow_driven_staging)
[0m19:09:02.416953 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m19:09:02.417519 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m19:09:02.418050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:09:02.423418 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m19:09:02.424191 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m19:09:02.424767 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m19:09:02.428963 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m19:09:02.432596 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m19:09:02.433693 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m19:09:02.442562 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:02.443146 [debug] [MainThread]: On master: BEGIN
[0m19:09:02.443627 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:09:02.448907 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:09:02.449918 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:02.450513 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:09:02.455632 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:09:02.457616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fd7d98c-ff04-4184-9d59-eb3ac7746d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78983f468950>]}
[0m19:09:02.458481 [debug] [MainThread]: On master: ROLLBACK
[0m19:09:02.459210 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:02.459762 [debug] [MainThread]: On master: BEGIN
[0m19:09:02.460744 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:09:02.461511 [debug] [MainThread]: On master: COMMIT
[0m19:09:02.462167 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:02.462804 [debug] [MainThread]: On master: COMMIT
[0m19:09:02.464098 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:09:02.465063 [debug] [MainThread]: On master: Close
[0m19:09:02.465958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:09:02.466566 [info ] [MainThread]: 
[0m19:09:02.480073 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_address
[0m19:09:02.481447 [info ] [Thread-1 (]: 1 of 5 START sql table model driven_staging.dim_address ........................ [RUN]
[0m19:09:02.482649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now model.dbt_driven_data.staging_dim_address)
[0m19:09:02.483423 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_address
[0m19:09:02.496652 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_address"
[0m19:09:02.498206 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_address
[0m19:09:02.593800 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_address"
[0m19:09:02.594864 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m19:09:02.595780 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: BEGIN
[0m19:09:02.596941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:02.602594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m19:09:02.603485 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m19:09:02.604346 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */

  
    

  create  table "airflow"."driven_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 unique_id,
 address,
 mac_address,
 ip_address
 FROM
 "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m19:09:02.611905 [debug] [Thread-1 (]: SQL status: SELECT 1061 in 0.007 seconds
[0m19:09:02.622812 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m19:09:02.623418 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m19:09:02.624427 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:09:02.630514 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m19:09:02.631717 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m19:09:02.633020 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:09:02.662158 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m19:09:02.662902 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m19:09:02.663602 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m19:09:02.666117 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:09:02.675124 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_address__dbt_backup"
[0m19:09:02.684332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m19:09:02.684958 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
drop table if exists "airflow"."driven_staging"."dim_address__dbt_backup" cascade
[0m19:09:02.687835 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:09:02.691444 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: Close
[0m19:09:02.693421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd7d98c-ff04-4184-9d59-eb3ac7746d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78983fe21280>]}
[0m19:09:02.694387 [info ] [Thread-1 (]: 1 of 5 OK created sql table model driven_staging.dim_address ................... [[32mSELECT 1061[0m in 0.21s]
[0m19:09:02.695868 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_address
[0m19:09:02.696718 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_date
[0m19:09:02.698079 [info ] [Thread-1 (]: 2 of 5 START sql table model driven_staging.dim_date ........................... [RUN]
[0m19:09:02.699533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_address, now model.dbt_driven_data.staging_dim_date)
[0m19:09:02.700653 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_date
[0m19:09:02.706832 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_date"
[0m19:09:02.707820 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_date
[0m19:09:02.712545 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_date"
[0m19:09:02.713646 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m19:09:02.714648 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: BEGIN
[0m19:09:02.715825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:02.721724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m19:09:02.722743 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m19:09:02.723427 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */

  
    

  create  table "airflow"."driven_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m19:09:02.726569 [debug] [Thread-1 (]: SQL status: SELECT 1061 in 0.003 seconds
[0m19:09:02.732229 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m19:09:02.733460 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m19:09:02.735250 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:09:02.740058 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m19:09:02.740709 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m19:09:02.741679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:09:02.744268 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m19:09:02.744897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m19:09:02.745452 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m19:09:02.747257 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:09:02.751754 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_date__dbt_backup"
[0m19:09:02.753442 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m19:09:02.754223 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
drop table if exists "airflow"."driven_staging"."dim_date__dbt_backup" cascade
[0m19:09:02.756802 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:09:02.758965 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: Close
[0m19:09:02.759811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd7d98c-ff04-4184-9d59-eb3ac7746d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78983d13d280>]}
[0m19:09:02.760758 [info ] [Thread-1 (]: 2 of 5 OK created sql table model driven_staging.dim_date ...................... [[32mSELECT 1061[0m in 0.06s]
[0m19:09:02.761885 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_date
[0m19:09:02.762715 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_finance
[0m19:09:02.763635 [info ] [Thread-1 (]: 3 of 5 START sql table model driven_staging.dim_finance ........................ [RUN]
[0m19:09:02.764938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_date, now model.dbt_driven_data.staging_dim_finance)
[0m19:09:02.766211 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_finance
[0m19:09:02.771501 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_finance"
[0m19:09:02.772629 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_finance
[0m19:09:02.777723 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_finance"
[0m19:09:02.778673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m19:09:02.779339 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: BEGIN
[0m19:09:02.779977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:02.785558 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m19:09:02.786364 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m19:09:02.787069 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */

  
    

  create  table "airflow"."driven_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 unique_id,
 iban
 FROM
 "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m19:09:02.791917 [debug] [Thread-1 (]: SQL status: SELECT 1061 in 0.004 seconds
[0m19:09:02.795681 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m19:09:02.796348 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m19:09:02.797402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:09:02.802432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m19:09:02.803194 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m19:09:02.804349 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:09:02.809897 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m19:09:02.810600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m19:09:02.811232 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m19:09:02.813000 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:09:02.818341 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_finance__dbt_backup"
[0m19:09:02.819644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m19:09:02.820590 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
drop table if exists "airflow"."driven_staging"."dim_finance__dbt_backup" cascade
[0m19:09:02.823635 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:09:02.826943 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: Close
[0m19:09:02.828188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd7d98c-ff04-4184-9d59-eb3ac7746d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78983c597260>]}
[0m19:09:02.829808 [info ] [Thread-1 (]: 3 of 5 OK created sql table model driven_staging.dim_finance ................... [[32mSELECT 1061[0m in 0.06s]
[0m19:09:02.832094 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_finance
[0m19:09:02.833534 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_person
[0m19:09:02.834787 [info ] [Thread-1 (]: 4 of 5 START sql table model driven_staging.dim_person ......................... [RUN]
[0m19:09:02.835619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_finance, now model.dbt_driven_data.staging_dim_person)
[0m19:09:02.836631 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_person
[0m19:09:02.842256 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_person"
[0m19:09:02.843573 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_person
[0m19:09:02.850983 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_person"
[0m19:09:02.852758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m19:09:02.853871 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: BEGIN
[0m19:09:02.854782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:02.861788 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m19:09:02.863077 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m19:09:02.864369 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */

  
    

  create  table "airflow"."driven_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 unique_id,
 person_name,
 user_name,
 email,
 phone,
 birth_date,
 personal_number
 FROM
 "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m19:09:02.874255 [debug] [Thread-1 (]: SQL status: SELECT 1061 in 0.008 seconds
[0m19:09:02.883905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m19:09:02.885057 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m19:09:02.886800 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:09:02.895354 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m19:09:02.896481 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m19:09:02.898636 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:09:02.903930 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m19:09:02.905329 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m19:09:02.906613 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m19:09:02.909543 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:09:02.916143 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_person__dbt_backup"
[0m19:09:02.918878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m19:09:02.920461 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
drop table if exists "airflow"."driven_staging"."dim_person__dbt_backup" cascade
[0m19:09:02.926238 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:09:02.930284 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: Close
[0m19:09:02.931969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd7d98c-ff04-4184-9d59-eb3ac7746d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78983c597a40>]}
[0m19:09:02.933943 [info ] [Thread-1 (]: 4 of 5 OK created sql table model driven_staging.dim_person .................... [[32mSELECT 1061[0m in 0.10s]
[0m19:09:02.939558 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_person
[0m19:09:02.940811 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_fact_network_usage
[0m19:09:02.943726 [info ] [Thread-1 (]: 5 of 5 START sql table model driven_staging.fact_network_usage ................. [RUN]
[0m19:09:02.946869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_person, now model.dbt_driven_data.staging_fact_network_usage)
[0m19:09:02.948006 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_fact_network_usage
[0m19:09:02.956858 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_fact_network_usage"
[0m19:09:02.959409 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_fact_network_usage
[0m19:09:02.968905 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_fact_network_usage"
[0m19:09:02.970521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m19:09:02.971803 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: BEGIN
[0m19:09:02.972971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:02.980016 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m19:09:02.981107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m19:09:02.982246 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."driven_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 unique_id,
 session_duration,
 download_speed,
 upload_speed,
 consumed_traffic
 FROM
 "airflow"."driven_raw"."raw_batch_data"
)
SELECT
 *
FROM
 source_data
  );
  
[0m19:09:02.989119 [debug] [Thread-1 (]: SQL status: SELECT 1061 in 0.005 seconds
[0m19:09:02.997804 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m19:09:03.001339 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m19:09:03.004766 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:09:03.014280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m19:09:03.015677 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m19:09:03.017554 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:09:03.024512 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m19:09:03.025169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m19:09:03.025723 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m19:09:03.029103 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:09:03.037055 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."fact_network_usage__dbt_backup"
[0m19:09:03.039510 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m19:09:03.040786 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
drop table if exists "airflow"."driven_staging"."fact_network_usage__dbt_backup" cascade
[0m19:09:03.044009 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:09:03.046942 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: Close
[0m19:09:03.049117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd7d98c-ff04-4184-9d59-eb3ac7746d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78983c5a5ee0>]}
[0m19:09:03.050932 [info ] [Thread-1 (]: 5 of 5 OK created sql table model driven_staging.fact_network_usage ............ [[32mSELECT 1061[0m in 0.10s]
[0m19:09:03.053319 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_fact_network_usage
[0m19:09:03.056336 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:03.057120 [debug] [MainThread]: On master: BEGIN
[0m19:09:03.057733 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:09:03.063246 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:09:03.064728 [debug] [MainThread]: On master: COMMIT
[0m19:09:03.066005 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:03.067295 [debug] [MainThread]: On master: COMMIT
[0m19:09:03.068600 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:09:03.069310 [debug] [MainThread]: On master: Close
[0m19:09:03.070304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:09:03.071109 [debug] [MainThread]: Connection 'model.dbt_driven_data.staging_fact_network_usage' was properly closed.
[0m19:09:03.072061 [info ] [MainThread]: 
[0m19:09:03.073230 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m19:09:03.076739 [debug] [MainThread]: Command end result
[0m19:09:03.129183 [info ] [MainThread]: 
[0m19:09:03.130133 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:09:03.131430 [info ] [MainThread]: 
[0m19:09:03.132649 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:09:03.134604 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0867684, "process_user_time": 5.140542, "process_kernel_time": 0.476659, "process_mem_max_rss": "119940", "process_in_blocks": "36064", "process_out_blocks": "6000"}
[0m19:09:03.135722 [debug] [MainThread]: Command `dbt run` succeeded at 19:09:03.135503 after 2.09 seconds
[0m19:09:03.136463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78983f9b6f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78983fe65880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78983fe65a00>]}
[0m19:09:03.137346 [debug] [MainThread]: Flushing usage events
[0m19:09:09.908085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a47ed54e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a47eceb080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a47efbaba0>]}


============================== 19:09:09.919410 | b76ea308-cb96-431a-ab81-ff1b1709b162 ==============================
[0m19:09:09.919410 [info ] [MainThread]: Running with dbt=1.8.0
[0m19:09:09.920328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:trusted', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:09:10.203147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b76ea308-cb96-431a-ab81-ff1b1709b162', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a47fdeae10>]}
[0m19:09:10.301643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b76ea308-cb96-431a-ab81-ff1b1709b162', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a47e420410>]}
[0m19:09:10.302704 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:09:10.567925 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m19:09:10.780680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:09:10.781309 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:09:10.841499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b76ea308-cb96-431a-ab81-ff1b1709b162', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a47df2b200>]}
[0m19:09:10.999109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b76ea308-cb96-431a-ab81-ff1b1709b162', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a47d72d820>]}
[0m19:09:10.999990 [info ] [MainThread]: Found 9 models, 7 sources, 428 macros
[0m19:09:11.000672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b76ea308-cb96-431a-ab81-ff1b1709b162', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a47df4eea0>]}
[0m19:09:11.003325 [info ] [MainThread]: 
[0m19:09:11.004238 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:09:11.010829 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m19:09:11.076195 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m19:09:11.076976 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m19:09:11.078042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:11.084824 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m19:09:11.086622 [debug] [ThreadPool]: On list_airflow: Close
[0m19:09:11.089746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_staging)
[0m19:09:11.099107 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m19:09:11.099750 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m19:09:11.100328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:09:11.105691 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m19:09:11.106640 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m19:09:11.107619 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m19:09:11.112426 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m19:09:11.114317 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m19:09:11.115019 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m19:09:11.116132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now list_airflow_driven_trusted)
[0m19:09:11.121497 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m19:09:11.122095 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m19:09:11.122569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:09:11.128120 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m19:09:11.129100 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m19:09:11.129960 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m19:09:11.133879 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m19:09:11.135678 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m19:09:11.136305 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m19:09:11.148744 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:11.149653 [debug] [MainThread]: On master: BEGIN
[0m19:09:11.150499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:09:11.155726 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:09:11.156741 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:11.157785 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:09:11.164167 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m19:09:11.166351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b76ea308-cb96-431a-ab81-ff1b1709b162', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a47d3fb2c0>]}
[0m19:09:11.167249 [debug] [MainThread]: On master: ROLLBACK
[0m19:09:11.168096 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:11.168626 [debug] [MainThread]: On master: BEGIN
[0m19:09:11.169483 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:09:11.170817 [debug] [MainThread]: On master: COMMIT
[0m19:09:11.172041 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:11.173337 [debug] [MainThread]: On master: COMMIT
[0m19:09:11.174650 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:09:11.175396 [debug] [MainThread]: On master: Close
[0m19:09:11.176785 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:09:11.179279 [info ] [MainThread]: 
[0m19:09:11.202126 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_non_pii_data
[0m19:09:11.203539 [info ] [Thread-1 (]: 1 of 4 START sql table model driven_trusted.non_pii_data ....................... [RUN]
[0m19:09:11.205027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now model.dbt_driven_data.trusted_non_pii_data)
[0m19:09:11.206122 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_non_pii_data
[0m19:09:11.225055 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_non_pii_data"
[0m19:09:11.226426 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_non_pii_data
[0m19:09:11.293719 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_non_pii_data"
[0m19:09:11.295719 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m19:09:11.296558 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: BEGIN
[0m19:09:11.297260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:11.303475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m19:09:11.304752 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m19:09:11.305997 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 '***MASKED***' AS person_name,
 SUBSTRING(dp.user_name, 1, 5) || '*****' user_name,
 SUBSTRING(dp.email, 1, 5) || '*****' AS email,
 '***MASKED***' AS personal_number,
 '***MASKED***' AS birth_date,
 '***MASKED***' AS address,
 '***MASKED***' AS phone,
 SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
 SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
 SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
 dd.accessed_at,
 fnu.session_duration,
 fnu.download_speed,
 fnu.upload_speed,
 fnu.consumed_traffic,
 fnu.unique_id
 FROM
 "airflow"."driven_staging"."fact_network_usage" fnu
 INNER JOIN
 "airflow"."driven_staging"."dim_address" da ON
fnu.unique_id = da.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_date" dd ON da.unique_id =
dd.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_finance" df ON dd.unique_id
= df.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_person" dp ON df.unique_id
= dp.unique_id
)
SELECT
 *
FROM
 source_data
  );
  
[0m19:09:11.340925 [debug] [Thread-1 (]: SQL status: SELECT 1061 in 0.034 seconds
[0m19:09:11.384399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m19:09:11.386954 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m19:09:11.389592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:09:11.400042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m19:09:11.401252 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m19:09:11.402426 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:09:11.441224 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m19:09:11.441896 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m19:09:11.442720 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m19:09:11.444959 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:09:11.454320 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."non_pii_data__dbt_backup"
[0m19:09:11.463574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m19:09:11.464214 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
drop table if exists "airflow"."driven_trusted"."non_pii_data__dbt_backup" cascade
[0m19:09:11.466980 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:09:11.470315 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: Close
[0m19:09:11.473697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76ea308-cb96-431a-ab81-ff1b1709b162', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a47f10fd10>]}
[0m19:09:11.475125 [info ] [Thread-1 (]: 1 of 4 OK created sql table model driven_trusted.non_pii_data .................. [[32mSELECT 1061[0m in 0.27s]
[0m19:09:11.476581 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_non_pii_data
[0m19:09:11.478368 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_payment_data
[0m19:09:11.479554 [info ] [Thread-1 (]: 2 of 4 START sql table model driven_trusted.payment_data ....................... [RUN]
[0m19:09:11.480280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_non_pii_data, now model.dbt_driven_data.trusted_payment_data)
[0m19:09:11.480816 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_payment_data
[0m19:09:11.485851 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_payment_data"
[0m19:09:11.486831 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_payment_data
[0m19:09:11.491869 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_payment_data"
[0m19:09:11.492789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m19:09:11.493546 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: BEGIN
[0m19:09:11.494411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:11.499692 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m19:09:11.500816 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m19:09:11.501368 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */

  
    

  create  table "airflow"."driven_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 fnu.unique_id,
 df.iban,
 fnu.download_speed,
 fnu.upload_speed,
 fnu.session_duration,
 fnu.consumed_traffic,
 ((fnu.download_speed + fnu.upload_speed + 1)/2) +
(fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
 FROM
 "airflow"."driven_staging"."fact_network_usage" fnu
 JOIN
 "airflow"."driven_staging"."dim_finance" df
 ON
 fnu.unique_id = df.unique_id
)
SELECT
 *
FROM
 source_data
  );
  
[0m19:09:11.506370 [debug] [Thread-1 (]: SQL status: SELECT 1061 in 0.004 seconds
[0m19:09:11.511465 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m19:09:11.512307 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m19:09:11.513273 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:09:11.517576 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m19:09:11.518171 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m19:09:11.519205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:09:11.522294 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m19:09:11.522953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m19:09:11.523543 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m19:09:11.525314 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:09:11.529928 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."payment_data__dbt_backup"
[0m19:09:11.531101 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m19:09:11.531795 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
drop table if exists "airflow"."driven_trusted"."payment_data__dbt_backup" cascade
[0m19:09:11.534449 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:09:11.536365 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: Close
[0m19:09:11.537314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76ea308-cb96-431a-ab81-ff1b1709b162', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a47c30b980>]}
[0m19:09:11.538618 [info ] [Thread-1 (]: 2 of 4 OK created sql table model driven_trusted.payment_data .................. [[32mSELECT 1061[0m in 0.06s]
[0m19:09:11.539955 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_payment_data
[0m19:09:11.540616 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_pii_data
[0m19:09:11.541373 [info ] [Thread-1 (]: 3 of 4 START sql table model driven_trusted.pii_data ........................... [RUN]
[0m19:09:11.542268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_payment_data, now model.dbt_driven_data.trusted_pii_data)
[0m19:09:11.543404 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_pii_data
[0m19:09:11.551234 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_pii_data"
[0m19:09:11.552236 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_pii_data
[0m19:09:11.558769 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_pii_data"
[0m19:09:11.560342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m19:09:11.561692 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: BEGIN
[0m19:09:11.562932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:11.568706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m19:09:11.569869 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m19:09:11.571434 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 dp.person_name,
 dp.user_name,
 dp.email,
 dp.personal_number,
 dp.birth_date,
 da.address,
 dp.phone,
 da.mac_address,
 da.ip_address,
 df.iban,
 dd.accessed_at,
 fnu.session_duration,
 fnu.download_speed,
 fnu.upload_speed,
 fnu.consumed_traffic,
 fnu.unique_id
 FROM
 "airflow"."driven_staging"."fact_network_usage" fnu
 INNER JOIN
 "airflow"."driven_staging"."dim_address" da ON
fnu.unique_id = da.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_date" dd ON da.unique_id =
dd.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_finance" df ON dd.unique_id
= df.unique_id
 INNER JOIN
 "airflow"."driven_staging"."dim_person" dp ON df.unique_id
= dp.unique_id
)
SELECT
 *
FROM
 source_data
  );
  
[0m19:09:11.588161 [debug] [Thread-1 (]: SQL status: SELECT 1061 in 0.016 seconds
[0m19:09:11.592353 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m19:09:11.593110 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m19:09:11.596814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:09:11.601650 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m19:09:11.602340 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m19:09:11.603700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:09:11.607514 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m19:09:11.608654 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m19:09:11.609630 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m19:09:11.612907 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:09:11.616702 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."pii_data__dbt_backup"
[0m19:09:11.618199 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m19:09:11.618729 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
drop table if exists "airflow"."driven_trusted"."pii_data__dbt_backup" cascade
[0m19:09:11.621660 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:09:11.623616 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: Close
[0m19:09:11.624609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76ea308-cb96-431a-ab81-ff1b1709b162', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a47b74af60>]}
[0m19:09:11.626384 [info ] [Thread-1 (]: 3 of 4 OK created sql table model driven_trusted.pii_data ...................... [[32mSELECT 1061[0m in 0.08s]
[0m19:09:11.628804 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_pii_data
[0m19:09:11.629751 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_technical_data
[0m19:09:11.630620 [info ] [Thread-1 (]: 4 of 4 START sql table model driven_trusted.technical_data ..................... [RUN]
[0m19:09:11.631969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_pii_data, now model.dbt_driven_data.trusted_technical_data)
[0m19:09:11.633564 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_technical_data
[0m19:09:11.639126 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_technical_data"
[0m19:09:11.639956 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_technical_data
[0m19:09:11.646780 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_technical_data"
[0m19:09:11.647899 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m19:09:11.648646 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: BEGIN
[0m19:09:11.649306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:11.654350 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m19:09:11.655477 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m19:09:11.656252 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */

  
    

  create  table "airflow"."driven_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
 SELECT
 fnu.unique_id,
 da.address,
 da.mac_address,
 da.ip_address,
 fnu.download_speed,
 fnu.upload_speed,
 ROUND((fnu.session_duration/60), 1) as min_session_duration,
 CASE
WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR
fnu.session_duration/60 < 1 THEN true
 ELSE false
 END AS technical_issue
 FROM
 "airflow"."driven_staging"."fact_network_usage" fnu
 JOIN
 "airflow"."driven_staging"."dim_address" da
 ON
 fnu.unique_id = da.unique_id
)
SELECT
 *
FROM
 source_data
  );
  
[0m19:09:11.666334 [debug] [Thread-1 (]: SQL status: SELECT 1061 in 0.009 seconds
[0m19:09:11.670960 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m19:09:11.671738 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m19:09:11.673241 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:09:11.678445 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m19:09:11.679110 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m19:09:11.680084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:09:11.682830 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m19:09:11.683563 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m19:09:11.684116 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m19:09:11.686147 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:09:11.689756 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."technical_data__dbt_backup"
[0m19:09:11.690835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m19:09:11.691389 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
drop table if exists "airflow"."driven_trusted"."technical_data__dbt_backup" cascade
[0m19:09:11.694295 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:09:11.696981 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: Close
[0m19:09:11.697909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76ea308-cb96-431a-ab81-ff1b1709b162', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a47c31fcb0>]}
[0m19:09:11.699152 [info ] [Thread-1 (]: 4 of 4 OK created sql table model driven_trusted.technical_data ................ [[32mSELECT 1061[0m in 0.07s]
[0m19:09:11.700888 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_technical_data
[0m19:09:11.702889 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:11.703452 [debug] [MainThread]: On master: BEGIN
[0m19:09:11.704268 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:09:11.709227 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:09:11.710420 [debug] [MainThread]: On master: COMMIT
[0m19:09:11.711680 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:11.712545 [debug] [MainThread]: On master: COMMIT
[0m19:09:11.713292 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:09:11.713924 [debug] [MainThread]: On master: Close
[0m19:09:11.715071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:09:11.716199 [debug] [MainThread]: Connection 'model.dbt_driven_data.trusted_technical_data' was properly closed.
[0m19:09:11.717270 [info ] [MainThread]: 
[0m19:09:11.718096 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m19:09:11.720766 [debug] [MainThread]: Command end result
[0m19:09:11.772111 [info ] [MainThread]: 
[0m19:09:11.772781 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:09:11.773385 [info ] [MainThread]: 
[0m19:09:11.773968 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:09:11.775289 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9980026, "process_user_time": 4.70436, "process_kernel_time": 0.377627, "process_mem_max_rss": "119420", "process_out_blocks": "1928", "process_in_blocks": "0"}
[0m19:09:11.776182 [debug] [MainThread]: Command `dbt run` succeeded at 19:09:11.775957 after 2.00 seconds
[0m19:09:11.777104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a47ec478c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a47d34c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a47df093a0>]}
[0m19:09:11.778514 [debug] [MainThread]: Flushing usage events
